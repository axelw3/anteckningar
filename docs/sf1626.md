# SF1626 Flervariabelanalys 7,5 hp
|Tillfälleskod|Termin(er)|Period(er)|Föreläsare|
|-|-|-|-|
|60108|VT2024|4|Tommy Ekola|

## Blandade begrepp
$C^1$-funktioner: Definierad & 1 gång kontinuerligt deriverbar i en omgivning.
$C^2$-funktioner: Definierad & 2 gånger kontinuerligt deriverbar i en omgivning.

## Föreläsning 0
**Halvplan:** Område på ena sidan av en linje.
Exempel: $(a,b)\cdot(x-x_0,y-y_0)>0$ är halvplanet för linjen $(a,b)\cdot(x-x_0,y-y_0)$ på den sida normalen $(a,b)$ pekar åt.

Motsvarande gäller för plan och halvrum.
## Föreläsning 1
### Koordinatsystem
**Polära koordinater:** $(r,\theta)$<br>
**Sfäriska koordinater:** $(r,\phi,\theta)$ där $\theta$ är longitud, $\phi$ latitud och $r$ radien.

### Topologiska begrepp
* **Omgivning:** En öppen cirkelskiva centrerad kring en punkt.
* **Inre punkt:** En punkt som har någon omgivning helt i mängden.
* **Yttre punkt:** En punkt som har någon omgivning helt utanför mängden.
* **Randpunkt:** En punkt som varken är en inre eller yttre punkt.
* **Öppen mängd:** Innehåller inga randpunkter.
* **Sluten mängd:** Innehåller alla randpunkter.
* **Begränsad mängd:** Ryms inuti en öppen cirkelskiva med ändlig radie.
* **Kompakt mängd:** Är sluten & begränsad.

## Föreläsning 2
### Parameterkurvor
En **parameterkurva** är en kurva där koordinaterna styrs av en parameter: $\bar r(t)=(x(t),y(t))$ eller $\bar r(t)=(x(t),y(t),z(t))$

**Orienterad kurva:** En kurva med en angiven riktning. T.ex. en parameterkurva $\bar r(t)$ då $t:a\to b$

### Riktningsvektor
En vektor som är parallell med tangentriktningen.

$$\dot{\bar r}(t_0)=\frac d{dt}\bar r(t)\vert_{t=t_0}=(\dot x(t_0),\dot y(t_0))$$

**Singulär punkt:** En punkt på parameterkurvan där $\dot{\bar r}(t)=\bar0$. Här kan kurvan tvärt byta riktning.

### Båglängd
En paramterkurva som är kontinuerligt deriverbar på $[a,b]$ har båglängd

$$L=\int_a^bds=\int_a^b\sqrt{\left(\frac{dx}{dt}\right)^2+\left(\frac{dy}{dt}\right)^2}dt$$

Uttrycket $ds=|\dot{\bar r}(t)|dt$ kallas för *bågelementet*.

## Föreläsning 3
### Funktioner
En funktion $f:\mathbb R^m\to\mathbb R^n$ definierar, för varje $\bar x\in D_f$, precis ett tal $\bar y\in V_f$.

**Reellvärd funktion:** $f:\mathbb R^m\to\mathbb R$
**Vektorvärd funktion:** $f:\mathbb R^m\to\mathbb R^n,n\gt1$

**Funktionskurva:** $y=f(x)$
**Funktionsyta:** $z=f(x,y)$

**Nivåkurva:** En kurva i planet där $f(x,y)=C$ för en bestämd konstant $C$.
**Nivåyta:** En yta i rummet där $f(x,y,z)=C$ för en bestämd konstant $C$.

#### Elementära funktioner
Elementära funktioner byggs upp genom sammansättning av *enkla funktioner*:

* $(x,y)\mapsto x+y$
* $(x,y)\mapsto x-y$
* $(x,y)\mapsto xy$
* $(x,y)\mapsto \frac xy$
* $(x,y)\mapsto \text{konstant}$
* Exponential- och logaritmfunktioner
* Trigonometriska och cyklometriska funktioner

### Inversfunktioner
*Inversfunktionen* till $f:\mathbb R^m\to\mathbb R^n$ är den funktion $f^{-1}:\mathbb R^n\to\mathbb R^m$ s.a.

$$f^{-1}\circ f(x)=x\text{ för alla }x\in D_f$$

Bijektiv (*surjektiv och injektiv*)$\iff$Inverterbar

## Föreläsning 4
Om en funktion närmar sig $\bar v$ i takt med att $\bar x\to\bar w$,  *oavsett vilken väg man väljer till $\bar w$*, gäller att

$$\lim_{\bar x\to\bar w}f(\bar x)=\bar v$$

### Räkneregler
* $\lim f(x,y)+g(x,y)=\lim f(x,y)+\lim g(x,y)$
* $\lim f(x,y)g(x,y)=\lim f(x,y)\cdot\lim g(x,y)$
* $\lim \frac{f(x,y)}{g(x,y)}=\frac{\lim f(x,y)}{\lim g(x,y)}$ om $\lim g(x,y)\neq0$
* $\lim h(f(x,y))=h(\lim f(x,y))$ om $h$ är kontinuerlig

### Instängningsprincipen
Om $g(x,y)\leq f(x,y)\leq h(x,y)$ i en omgivning till $(a,b)$ och $g(x,y)\rarr c\larr h(x,y)$ när $(x,y)\to(a,b)$ så gäller att även

$$\lim_{(x,y)\to(a,b)}f(x,y)= c$$

#### Polära & sfäriska koordinater
Gränsövergångarna $(x,y)\to(0,0)$ och $(x,y,z)\to(0,0,0)$ kan skrivas som $(r,\theta)\to(0,\text{ospec.})$ respektive $(r,\phi,\theta)\to(0,\text{ospec.},\text{ospec.})$.

### Kontinuerliga funktioner
En funktion $f(x,y)$ är kontinuerlig i $(a,b)$ omm:

$$\lim_{(x,y)\to(a,b)}f(x,y)=f(a,b)$$

Liksom generellt för gränsvärden med flera variabler måste detta gälla *oavsett hur $(x,y)\to(a,b)$*.

Om $f,g$ är kontinuerliga funktioner är också $f\circ g$ en kontinuerlig funktion.

> De enkla funktionerna är kontinuerliga
> $\implies$ **Alla elementära funktioner är kontinuerliga.**


## Föreläsning 5
### Derivata för reellvärda funktioner av en variabel
$$f'(a)=\lim_{h\to0}\frac{f(a+h)-f(a)}{h}$$

### Partialderivata
För reellvärda funktioner av två variabler definieras partialderivatorna av $f$ i punkten $(a,b)$ som

$$f'_x(a,b)=\frac d{dx}f(x,b)\vert_{x=a}=\lim_{h\to0}\frac{f(a+h,b)-f(a,b)}h\\f'_y(a,b)=\frac d{dy}f(a,y)\vert_{y=a}=\lim_{k\to0}\frac{f(a,b+k)-f(a,b)}k$$

### Tangentplan
En normal till tangentplanet till $z=f(x,y)$ i $(a,b,f(a,b))$ ges av

$$\bar n=\begin{pmatrix}1\\0\\f'_x(a,b)\end{pmatrix}\times\begin{pmatrix}0\\1\\f'_y(a,b)\end{pmatrix}$$

Tangentplanet ges alltså av:

$$0=\begin{pmatrix}x-a\\y-b\\z-f(a,b)\end{pmatrix}\times\bar n$$

### Högre ordningens partialderivator
För en reellvärd funktion $f(x,y)$ definieras andra ordningens partialderivator i $(a,b)$ av:

$$\begin{aligned}&f''_{xx}(a,b)=\frac{\partial^2}{\partial x^2}f(x,y)\\&\left.\!\!\begin{aligned}f''_{xy}(a,b)=\frac{\partial^2}{\partial y\partial x}f(x,y)\\f''_{yx}(a,b)=\frac{\partial^2}{\partial x\partial y}f(x,y)\end{aligned}\right\} \text{samma}\\&f''_{yy}(a,b)=\frac{\partial^2}{\partial y^2}f(x,y)&\end{aligned}$$

> Om $f$ är 2 gånger kontinuerligt deriverbar i $(a,b)$ gäller att $f''_{xy}(a,b)=f''_{yx}(a,b)$.

### Kedjeregeln för reellvärda funktioner
#### En variabel
Låt $t\mapsto x(t)\mapsto f(x(t))$.
Om $f(x)$ och $x(t)$ är kontinuerligt deriverbara, är
$\frac{df}{dt}=\frac{df}{dx}\frac{dx}{dt}=f'(x)x'(t)=f'(x(t))x'(t)$

#### Flera variabler
Anta t.ex. $t\mapsto\begin{pmatrix}x(t)\\y(t)\end{pmatrix}\mapsto f(x(t),y(t))$

$\frac {df}{dt}=\frac {df}{dx}\frac{dx}{dt}+\frac{df}{dy}\frac{dy}{dt}=f'_x(x(t),y(t))x'(t)+f'_y(x(t),y(t))y'(t)$

#### Variabelträd
Om vi har t.ex. $f(x(s,t),y(s,t),z(s,u(t)))$, så kan vi rita ett *variabelträd* som visar hur uttrycket är uppbyggt:

<center><svg width="300" height="185"><text text-anchor="middle" font-family="math,serif"><tspan x="150" y="23">f</tspan><tspan x="50" y="75">x</tspan><tspan x="150" y="75">y</tspan><tspan x="250" y="75">z</tspan><tspan x="20" y="125">s</tspan><tspan x="80" y="125">t</tspan><tspan x="120" y="125">s</tspan><tspan x="180" y="125">t</tspan><tspan x="220" y="125">s</tspan><tspan x="280" y="125">u</tspan><tspan x="280" y="175">t</tspan></text><path d="M149,29v20h-100v10h2v-8h98v8h2v-8h98v8h2v-10h-100v-20zM49,83v12h-30v14h2v-12h58v12h2v-14h-30v-12zM149,83v12h-30v14h2v-12h58v12h2v-14h-30v-12zM249,83v12h-30v14h2v-12h58v12h2v-14h-30v-12zM279,134v22h2v-22z"/></svg></center>

För att nu bestämma exempelvis $\frac{\partial}{\partial t}f(x(s,t),y(s,t),z(s,u(t)))$ hittar vi alla stigar från $f$ till variabeln, $t$:

<center><svg width="300" height="185"><path d="M148,27v27h-2v46h30v12h8v-20h-30v-38h-2v-27z" fill="#FF000075"/><path d="M146,27v19h-100v54h30v12h8v-20h-30v-38h94v-27" fill="#00FF0075"/><path d="M152,27h2v19h100v46h30v67h-8v-59h-30v-46h-94z" fill="#0000FF75"/><text text-anchor="middle" font-family="math,serif"><tspan x="150" y="23">f</tspan><tspan x="50" y="75">x</tspan><tspan x="150" y="75">y</tspan><tspan x="250" y="75">z</tspan><tspan x="20" y="125">s</tspan><tspan x="80" y="125">t</tspan><tspan x="120" y="125">s</tspan><tspan x="180" y="125">t</tspan><tspan x="220" y="125">s</tspan><tspan x="280" y="125">u</tspan><tspan x="280" y="175">t</tspan></text><path d="M149,29v20h-100v10h2v-8h98v8h2v-8h98v8h2v-10h-100v-20zM49,83v12h-30v14h2v-12h58v12h2v-14h-30v-12zM149,83v12h-30v14h2v-12h58v12h2v-14h-30v-12zM249,83v12h-30v14h2v-12h58v12h2v-14h-30v-12zM279,134v22h2v-22z"/></svg></center>

$$\frac{\partial}{\partial t}f(x(s,t),y(s,t),z(s,u(t)))={\color{lime}\frac{\partial f}{\partial x}\frac{\partial x}{\partial t}}+{\color{red}\frac{\partial f}{\partial y}\frac{\partial y}{\partial t}}+{\color{blue}\frac{\partial f}{\partial z}\frac{\partial z}{\partial u}\frac{\partial u}{\partial t}}$$

## Föreläsning 6
### Linjär approximation
#### En variabel
$f(a+h)\approx f(a)+f'(a)h$

#### Funktioner av två variabler
En funktion $f(x,y)$ approximeras linjärt kring $(a,b)$ av dess tangentplan.

$f(a+h,b+k)\approx f(a,b)+f'_x(a,b)h+f'_y(a,b)k$

### Differentierbarhet
Differentierbara funktioner ser lokalt ut som linjära funktioner.
#### En variabel
> Funktionen $f(x)$ är differentierbar om<br>
> $f(a+h)=(\text{linjär funktion i }h)+o(h)$, där $\lim_{h\to0}\frac{o(h)}h=0$<br>
> (dvs. när $h\to0$ går felet i approximationen $\to0$ snabbare än $h$ självt)

Den linjära funktionen som approximerar funktionen lokalt måste vara tangentens ekvation.
> **Bevis:** Antag att $f(x)$ är differentierbar i $x=a$.<br>
> Vi vet då att $f(a+h)=kh+m+o(h)$.<br>
> Sätt in $h=0\implies f(a)=m$<br>
> Vi har att $k=\frac{f(a+h)-m-o(h)}h$, och om vi låter $h\to0$ får vi<br>
> $\lim_{h\to0}\frac{f(a+h)-m-o(h)}h=\lim_{h\to0}\frac{f(a+h)-f(a)}h-\lim_{h\to0}\frac{o(h)}h\\=\lim_{h\to0}\frac{f(a+h)-f(a)}h=f'(a)$.<br>
> $\therefore f(a+h)=f'(a)h+f(a)+o(h)$

> *Exempel på icke-differentierbar funktion:* $f(x)=|x|$ i punkten $(0,0)$<br>
> Vi vill hitta $f(0+h)=a_0+a_1h+o(h)$<br>
> $f(0)=a_0+0a_1+0=0\implies a_0=f(0)=0$<br>
> För att vara differentierbar i punkten måste<br>
> $0=\lim_{h\to0}\frac{o(h)}h=\lim_{h\to0}\frac{f(0+h)-a_1h}h=\lim_{h\to0}\frac{|h|-a_1h}h=\lim_{h\to0}(\text{sgn}(h)-a_1)$<br>
> $a_1$ är en konstant (beror inte av $h$) $\implies$ gränsvärdet existerar ej.<br>
> $\therefore$ *Inte differentierbar i (0, 0).*

#### Funktioner av två variabler
> Funktionen $f(x,y)$ är differentierbar i $(a,b)$ om<br>
> $f(a+h,b+k)=(\text{linjär funktion i }h,k)+o(r)$, s.a. $\lim_{r\to0}\frac{o(r)}r$<br>
> och $r=|(h,k)|=\sqrt{h^2+k^2}$

Den linjära funktionen som approximerar funktionen lokalt måste vara tangentplanens ekvation.
> **Bevis:** Vi har $f(a+h,b+k)=a_0+a_1h+a_2k+o(r)$<br>
> $f(a,b)=a_0$<br>
> $f(a+h,b)=f(a,b)+a_1h+o(h)$<br>
> $\implies\lim_{h\to0}\frac{f(a+h,b)-f(a,b)}h=a_1+\lim_{h\to0}\frac{o(h)}h\implies f'_x(a,b)=a_1$<br>
> Motsvarande kan göras för $a_2$...

### Differentierbara funktioner
En *deriverbar* funktion är inte nödvändigtvis också *differentierbar*.
> **Viktig sats:**<br>
> Om alla partialderivator är definierade i en [omgivning](https://en.wikipedia.org/wiki/Neighbourhood_(mathematics) "Neighbourhood (mathematics)") till en punkt $\bar x_0$ och är kontinuerliga i punkten $\bar x_0$, så är funktionen differentierbar i denna punkt $\bar x_0$.
> 
> **Härledning:**
> Görs m.h.a. medelvärdessatsen.


## Föreläsning 7
Repetition:

* Derivata för reellvärda funktioner av flera variabler
* Partialderivata: Derivera m.a.p. $x$ eller $y$
* Kedjeregeln
* Linjär approximation
* Differentierbara funktioner: Funktioner som approximeras väl av sin linjära approximation.

Kontinuerliga partialderivator $\implies$ differentierbar

*Partialderivatorna* anger hur mycket funktionsytan lutar i $x$- eller $y$-led.
### Riktningsderivata
Vi undersöker istället funktionen utmed en viss enhetsriktning $û=(c,d)$ i x, y-planet.
Vi vill göra detta kring en punkt $(a,b)$. Linjen ges då av:

$$(x,y)=(a,b)+t(c,d)$$

Utmed denna linje antar funktionen värden $z=f(a+tc,b+td)$

$$f'_û(a,b)=\left.\frac d{dt}f(a+tc,b+td)\right\vert_{t=0}\\=\left.f'_x(a+tc,b+td)\cdot \frac d{dt}(a+tc)\right\vert_{t=0}+\left.f'_y(a+tc,b+td)\cdot \frac d{dt}(b+td)\right\vert_{t=0}\\=f'_x(a,b)\cdot c+f'_y(a,b)\cdot d\\=\left(f'_x(a,b),f'_y(a,b)\right)\cdot(c,d)\\=\nabla f(a,b)\cdot û\ \text{(gradientformeln)}$$

***Obs!** Gradientformeln gäller bara om funktionen är differentierbar i punkten (eftersom vi har använt kedjeregeln).*

> **Exempel 2:**<br>
> Beräkna riktningsderivatan av $f(x,y)=x^2+y^2$ i punkten $(1,2)$ och i riktningen $\vec v=(2,1)$.<br>
> För att ta fram gradientformeln ovan har vi använt kedjeregeln.<br>
> För att få använda kedjeregeln måste funktionen vara differentierbar.<br>
> $f'_x=2x\\f'_y=2y$<br>
> $f'_x,f'_y$ är polynom<br>
> $\implies$de är elementära funktioner<br>
> $\implies$de är kontinuerliga i hela definitionsmängden (dvs. hela $\mathbb R^2$)<br>
> $\implies f$ är kontinuerligt deriverbar<br>
> $\implies f$ är differentierbar
> 
> Gradientformeln ger<br>
> $f'_{\vec v}(1,2)=\nabla f(1,2)\cdot \vec v=(2x,2y)\vert_{(x,y)=(1,2)}\cdot \frac{(2,1)}{|(2,1)|}=\frac8{\sqrt5}$

> **Övning 1:**<br>
> Bestäm riktningsderivatan av $f(x,y)=xy$ i punkten $(2,-1)$ och i riktningen $\vec v=(3,4)$.<br>
> $f'_x=y$ och $f'_y=x\implies$$f$ är kontinuerligt deriverbar$\implies$differentierbar<br>
> Vi får då enligt gradientformeln<br>
> $f'_{\vec v}=\nabla f(2,-1)\cdot\frac{(3,4)}{|(3,4)|}=(-1,2)\cdot\frac{(3,4)}5=\frac{5}{5}=1$

**Från linjär algebra:**<br>
Om vinkeln mellan vektorerna $\vec u$ och $\vec v$ är $\theta$, så definieras

$$\vec u\cdot\vec v=|\vec u||\vec v|\cos\theta$$

Med detta kan vi skriva:

$$f'_{\vec u}(a,b)=\nabla f(a,b)\cdot\vec u=|\nabla f(a,b)||\vec u|\cos\theta$$

Om vi då har en enhetsvektor $\vec u$ som tangerar den aktuella nivåkurvan (*dvs. "funktionsvärdet ändras inte"*) gäller att $0=f'_{\vec u}=|\nabla f(a,b)|\cos\theta$.

**När blir $f'_{\vec u}$ som störst?**
När $\theta=0$, dvs. då $\vec u$ pekar i samma riktning som $\nabla f(a,b)$.

> **Exempel 4:** Temperaturen i ett rum ges av
> 
> $$T(x,y,z)=xy-x^2-z^2$$
> 
> och du befinner dig i punkten $(1,1,3)$.
> 
> a) I vilken riktning ökar temperaturen som mest?<br>
> $f'_x=y-2x\\f'_y=x\\f'_z=-2z$<br>
> Alltså är $f$ kontinuerligt deriverbar.<br>
> Temperaturen ökar som mest i riktningen ditåt $T'_{\vec u}(1,1,3)$ är som störst.<br>
> Välj $\vec u$ s.a. $T'_{\vec u}(1,1,3)=|\nabla T(1,1,3)||\vec u|\cos\theta$
> 
> Gradientformeln ger slutligen
> 
> $$\nabla T(1,1,3)=(y-2x,x,-2z)\vert_{(x,y,z)=(1,1,3)}\\=(-1,1,-6)$$
> 
> b) Ange en riktning vartåt temperaturökningen är noll.<br>
> T.ex. $(0,6,1)$

### Nivåkurvor
Ges av

$$f(x,y)=C$$

där $C$ är någon konstant

En nivåkurva $f(x,y)=C$ har i en punkt $(a,b)$ på kurvan normalvektorn

$$\vec n=\nabla f(a,b)$$

> **Exempel:** Låt $f(x,y)=x^2y+xy^3-x+1$. Bestäm tangentlinjen till nivåkurvan för $f$ genom punkten $(1,1)$.<br>
> $f'_x=2xy+y^3-1\\f'_y=x^2+3xy^2$<br>
> Dessa är kontinuerliga och alltså $f$ differentierbar.<br>
> $\nabla f(1,1)=\left.(2xy+y^3-1,x^2+3xy^2)\right\vert_{(x,y)=(1,1)}\\=(2,4)$<br>
> För att beskriva en linje behöver vi
> 
> 1. en punkt på linjen: *t.ex. $(1,1)$*
> 2. en riktning $\vec v$ för linjen: *en normal är $\nabla f(1,1)=(2,4)$*
> 
> Säg då t.ex. $\vec v=(2,-1)$ ty $\vec v\cdot\vec n=0$<br>
> **Svar:** Linjen ges slutligen av $(x,y)=(1,1)+t(2,-1)$

### Singulära punkter
Om en nivåkurva $f(x,y)=0$ har en punkt $(x_0,y_0)$ där

$$\nabla f(x_0,y_0)=(0,0)$$

då kallas $(x_0,y_0)$ för en *singulär punkt*. I en sådan punkt kan kurvan tvärt byta riktning.

> **Övning 4:**<br>
> Bestäm alla singulära punkter till nivåkurvan $y^3+2x-x^2=1$.<br>
> $\nabla f(x,y)=(2-2x,3y^2)=\vec0$<br>
> $2-2x=0\\3y^2=0$<br>
> Vi får $x=1$ och $y=0$, som också visar sig ligga på nivåkurvan.<br>
> **Svar:** $(1,0)$

### Nivåytor
Ges av

$$f(x,y,z)=C$$

där $C$ är någon konstant.

#### Normal till nivåytor
En nivåyta $f(x,y,z)=C$ har i en punkt $(a,b,c)$ på ytan normalvektorn

$$\vec n=\nabla f(a,b,c)$$

eftersom $(a,b,c)$ måste vara vinkelrät mot tangentplanet.

> **Exempel 6:**<br>
> Visa att planet $2x+2y-3z=2$ tangerar ytan $2x^2+2y^2-3z^2=4$<br>
> Låt
> 
> $$f(x,y,z)=2x+2y-3z-2\\g(x,y,z)=2x^2+2y^2-3z^2-4$$
> 
> Det ska finnas en tangeringspunkt $(a,b,c)$, dvs. en punkt som uppfyller<br>
> $\begin{cases}2a+2b-3c=2\\2a^2+2b^2-3c^2=4\\\text{normalerna till planet och ytan är parallella}\end{cases}$<br>
> dvs.<br>
> $\nabla f(a,b,c)\parallel \nabla g(a,b,c)$<br>
> dvs.<br>
> $\nabla f(a,b,c)=\lambda \nabla g(a,b,c)$<br>
> $(2,2,-3)=\lambda(4a,4b,-6c)$
> 
> Detta ger<br>
> $a=b=c=\frac1{2\lambda}$<br>
> vilket med ovan nämnda krav ger<br>
> $a=b=c=2$.<br>
> **Svar:** Ja, och tangeringspunkten är $(a,b,c)=(2,2,2)$.



## Föreläsning 8
### Vektorvärda funktioner
> **Differentierbarhet:** En funktion $\bar f:(x,y)\to(u(x,y),v(x,y))$ är differentierbar om komponenterna $u(x,y)$ och $v(x,y)$ är det.

Om en vektorvärd funktion är differentierbar, gäller att:<br>
$\bar f(a+h,b+k)=\bar f(a,b)+\begin{pmatrix}u_x'(a,b)&u_y'(a,b)\\v_x'(a,b)&v_y'(a,b)\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+o(r)$

Geometriskt betyder detta att en differentierbar funktion lokalt ser ut som en linjär avbildning med matrisen

$$J_{\bar f}=\frac{\partial f}{\partial(x,y)}=\begin{pmatrix}u_x'(a,b)&u_y'(a,b)\\v_x'(a,b)&v_y'(a,b)\end{pmatrix}$$

Detta kallas för *jakobianen* till $f$.

### Kedjeregeln för vektorvärda funktioner
$$\begin{pmatrix}s\\t\end{pmatrix}\mapsto\begin{pmatrix}x(s,t)\\y(s,t)\end{pmatrix}\mapsto\begin{pmatrix}u(x,y)\\v(x,y)\end{pmatrix}$$

$$\frac{\partial(u,v)}{\partial(s,t)}=\frac{\partial(u,v)}{\partial(x,y)}\frac{\partial(x,y)}{\partial(s,t)}$$

Detta eftersom avbildningarna $(s,t)\mapsto(x,y)$ och $(x,y)\mapsto(u,v)$ approximeras väl av de linjära avbildningarna med matris $\frac{\partial(x,y)}{\partial(s,t)}$ respektive $\frac{\partial(u,v)}{\partial(x,y)}$.

**Observera ordningen vid matrismultiplikation.**

### Allmänna kedjeregeln
För en allmän sammansättning $\begin{pmatrix}x_1\\\cdots\\x_m\end{pmatrix}\mapsto\begin{pmatrix}y_1\\\cdots\\y_n\end{pmatrix}\mapsto\begin{pmatrix}z_1\\\cdots\\z_p\end{pmatrix}$ gäller att

$$\frac{\partial(z_1,\dots,z_p)}{\partial(x_1,\dots,x_m)}=\frac{\partial(z_1,\dots,z_p)}{\partial(y_1,\dots,y_n)}\frac{\partial(y_1,\dots,y_n)}{\partial(x_1,\dots,x_m)}$$

#### Inversfunktionens jakobian
Inversfunktionen $f^{-1}:\begin{pmatrix}u\\v\end{pmatrix}\mapsto\begin{pmatrix}x\\y\end{pmatrix}$ avbildar utvärden $u,v$ tillbaka till motsvarande invärden $x,y$.
Dess jakobian är:

$$J_{f^{-1}}=\frac{\partial(x,y)}{\partial(u,v)}=\left(\frac{\partial(u,v)}{\partial(x,y)}\right)^{-1}$$

Detta eftersom inversen av en linjär avbildning (förutsatt inverterbarhet) ges av den inverterade avbildningsmatrisen.

> **Repetition:** Invertera 2x2-matriser
> 
> $$A^{-1}=\begin{bmatrix}a&b\\c&d\end{bmatrix}^{-1}=\frac1{\det A}\begin{bmatrix}d&-b\\-c&a\end{bmatrix}$$

### Transformation av differentialuttryck
Med kedjeregeln kan en funktions partialderivator uttryckas i olika koordinatsystem.

**Första ordningens uttryck:**
Om $\begin{cases}x=x(u,v)\\y=y(u,v)\end{cases}$ där $(u,v)$ är koordinaterna i ett annat koordinatsystem, gäller att $f(x,y)=f(x(u,v),y(u,v))$. Detta ger (med kedjeregeln) ett samband mellan $(f_u',f_v')$ och $(f_x',f_y')$:

$$\frac{\partial f}{\partial(u,v)}=\frac{\partial f}{\partial(x,y)}\frac{\partial(x,y)}{\partial(u,v)}$$


## Föreläsning 9
### Vektorfält
Viktigt i fysik. T.ex. tyngdkraftfält:

$$\bar F=-mg\bar e_z$$

**Fältlinjer:** En kurva i planet (eller rummet) som följer med vektorfältet. Dvs. en kurva som, i varje punkt på kurvan, har samma riktning som vektorfältet.

En kontinuerligt deriverbar parameterkurva $\bar r=\bar r(t)$ är en *fältlinje* till ett kontinuerligt deriverbart vektorfält $\bar F=\bar F(\bar r)$ om riktningsvektorn $\dot{\bar r}(t)$ är parallell med $\bar F(\bar r(t))$.

> **Exempel:** Bestäm fältlinjen till vektorfältet $\bar F(x,y)=(-y,x)$ som passerar punkten $(1,2)$.
> 
> Vi söker $(x,y)=(x(t),y(t))$ så att $(\dot x,\dot y))\parallel \bar F(x,y)=(-y,x)$.<br>
> $\iff(\dot x,\dot y)=\lambda(t)(-y,x)$ där $\lambda$ beror av $t$ eftersom faktorn inte behöver vara konstant.<br>
> $\iff\begin{cases}\dot x(t)=-\lambda(t)y(t)\\\dot y(t)=\lambda(t)x(t)\end{cases}$<br>
> $\iff\begin{cases}\dot xx=-\lambda(t)yx\\\dot yy=\lambda(t)xy\end{cases}$<br>
> $\iff\dot xx+\dot yy=0$
> 
> **Obs!** $2\dot xx=\frac d{dt}x^2\implies\dot xx=\frac12\frac d{dt}x^2$
> 
> $\implies\frac d{dt}(x(t)^2+y(t)^2)=0$<br>
> $\implies x(t)^2+y(t)^2=C$<br>
> Vi ser nu att fältlinjen är en cirkel kring origo med radie $\sqrt C$ som går genom punkten $(1,2)$.<br>
> Alltså $1^2+2^2=5=C$<br>
> **Svar:** Fältlinjen är en cirkel med medelpunkt i origo och radie $\sqrt5$.

### Arbete
> **Arbete:** $W=\bar F\cdot\Delta\bar r$<br>
> eftersom endast kraften i riktning $\Delta\bar r$ är viktig, och denna är projektionen på $\Delta\bar r$:
> 
> $$\bar F_\parallel=\text{proj}_{\Delta\bar r}\ \bar F=\frac{\bar F\cdot\Delta\bar r}{|\Delta\bar r|^2}\Delta\bar r\implies|\bar F_\parallel|=\frac{\bar F\cdot\Delta\bar r}{|\Delta\bar r|}\\\implies W=|\bar F_\parallel||\Delta\bar r|=\bar F\cdot\Delta\bar r$$

> **Exempel:** Bestäm det arbete som kraftfältet $\bar F=(1,1)$ utför på en partikel som rör sig $\Delta\bar r=(5,0)$.<br>
> **Svar:** $W=\bar F\cdot\Delta\bar r=(1,1)\cdot(5,0)=5$

I exemplen ovan antogs kraften vara konstant och rörelsen vara likformig.

Mer generellt kan arbetet som ett kraftfält $\bar F(\bar r)$ utför på en partikel som rör sig längs den riktade kurvan $\bar r(t)=(x(t),y(t))$, där $t:a\to b$ beskrivas av

$$W=\int_a^b\bar F(\bar r(t))\cdot\dot{\bar r}(t)dt$$

### Kurvintegral
Om $\bar F=\bar F(\bar r)$ är ett kontinuerligt vektorfält och $\gamma$ är en riktad kontinuerligt deriverbar kurva, så definieras kurvintegralen som

$$\int_\gamma\bar F(\bar r)\cdot d\bar r=\int_a^b\bar F(\bar r(t))\cdot\dot{\bar r}(t)dt$$

> **Vektoriellt bågelement:**
> Uttrycket $d\bar r=\frac {d\bar r}{dt}dt=\dot{\bar r}(t)dt$ kallas för den *vektoriella bågelementet*.


#### Kurvintegraler i skalär form
Om vi sätter $\bar F=(P(x,y),Q(x,y))$ och $d\bar r=(dx,dy)$ kan kurvintegralen även skrivas som

$$\int_\gamma\bar F(\bar r)\cdot d\bar r=\int_\gamma(P(x,y),Q(x,y))\cdot(dx,dy)\\=\int_\gamma P(x,y)dx+Q(x,y)dy$$

I rummet får vi istället

$$\int_\gamma\bar F(\bar r)\cdot d\bar r=\int_\gamma(P(x,y,z),Q(x,y,z),R(x,y,z))\cdot(dx,dy,dz)\\=\int_\gamma P(x,y,z)dx+Q(x,y,z)dy+R(x,y,z)dz$$

> **Övning:** Avläs vektorfältet $\bar F$ från kurvintegralerna.<br>
> a) $\int_\gamma xy^2dx-ydy$<br>
> $\bar F(\bar r)=(xy^2,-y)$<br>
> b) $\int_\gamma dy-xdx$<br>
> $\bar F(\bar r)=(-x,1)$<br>
> c) $\int_\gamma xydy$<br>
> $\bar F(\bar r)=(0,xy)$

> **Exempel:** Beräkna $\int_\gamma xydx+x^2dy$ där $\gamma$ är parabeln $x=2y^2,-1\leq y\leq1$.<br>
> Kurvan kan parametriseras $\begin{cases}x=2t^2\\y=t\end{cases},t:-1\to1$ vilket ger<br>
> $\bar F=(xy,x^2)=(2t^3,4t^4)$ och $d\bar r=\frac{d\bar r}{dt}dt=(4t,1)dt$.
> 
> $$\int_\gamma\bar F\cdot d\bar r=\int_{-1}^1(2t^3,4t^4)\cdot(4t,1)dt=\int_{-1}^112t^4dt=12\left[\frac{t^5}5\right]_{-1}^1=\frac{24}5$$

> **Exempel:** Beräkna $\int_\gamma(2x-y)dx+(-x+2y)dy+(2x-z)dz$ där $\gamma$ är linjestycket<br>
> $\bar r=(0,2,2)+t(2,-1,-2)\iff\begin{cases}x=2t\\y=2-t\\z=2-2t\end{cases}\text{då }t:0\to1$<br>
> Vi beräknar slutligen:<br>
> $\int_\gamma\bar F\cdot d\bar r=\int_0^1(2(2t)-(2-t),-(2t)+2(2-t),2(2t)-(2-2t))\cdot\frac{d\bar r}{dt}dt\\=\int_0^1(5t-2,4-4t,6t-2)\cdot(2,-1,-2)dt=\int_0^1(2t-4)dt=\left[t^2-4t\right]_0^1=-3$<br>
> **Svar:** $-3$

### Räkneregler
Om $\bar F,\bar G$ är kontinuerliga vektorfält, $a,b$ är konstanter, och $\gamma_1,\gamma_2$ är kontinuerligt deriverbara riktade kurvor, så är

1. $\int_{\gamma_1+\gamma_2}\bar F\cdot d\bar r=\int_{\gamma_1}\bar F\cdot d\bar r+\int_{\gamma_2}\bar F\cdot d\bar r$
2. $\int_{-\gamma_1}\bar F\cdot d\bar r=-\int_{\gamma_1}\bar F\cdot d\bar r$
3. $\int_{\gamma_1}(a\bar F+b\bar G)\cdot d\bar r=a\int_{\gamma_1}\bar F\cdot d\bar r+b\int_{\gamma_1}\bar G\cdot d\bar r$

> **Exempel:** Beräkna $\int_\gamma xdy$ där $\gamma$ är halvcirkeln medurs ovanför $x$-axeln med radien $1$, samt den räta linjen från $(1,0)$ till $(-1,0)$.<br>
> En parametrisering av halvcirkeln är $\begin{cases}x=\cos t\\y=\sin t\end{cases},t:\pi\to0$<br>
> $\int_\gamma xdy=\int_\gamma(0,x)\cdot d\bar r=\int_\pi^0(0,\cos t)\cdot (-\sin t,\cos t)dt+\int_1^{-1}(0,t)\cdot (1,0)dt\\=\int_\pi^0\cos^2(t)dt+\int_1^{-1}0dt=\left\{\cos(2t)=\cos^2t-\sin^2t\right\}=\int_\pi^0\frac{1+\cos(2t)}2dt\\=\frac12\left[t+\frac{\sin(2t)}2\right]_\pi^0=-\frac\pi2$
> 
> **Svar:** $-\frac\pi2$


## Föreläsning 10
### Topologiska begrepp
* Ett område är **sammanhängande** om varje par av punkter kan förbindas av en kurva som ligger helt i området.
* Ett område är **enkelt sammanhängande** om det är *sammanhängande*, samt varje sluten kurva i området, utan att lämna området, *kan deformeras till en punkt*.

### Konservativa vektorfält
> **Definition:** Ett *konservativt vektorfält* är ett vektorfält som är förändringsfältet till en underliggande skalär storhet U, dvs. $\bar F=\nabla U$. Storheten $U$ kallas för en *potential* till vektorfältet.
> 
> *Exempel: Tyngdkraftfältet är konservativt, med den potentiella energin som potential.*

> **Exempel:** Bestäm en potential till det konservativa vektorfältet $\bar F=(y^3+3x^2y^2,3xy^2+2x^3y)$.<br>
> Dvs. vi söker $U$ s.a. $\nabla U=\bar F$.<br>
> Vi vet att $\frac\partial{\partial x}U=y^3+3x^2y^2$ och $\frac\partial{\partial y}U=3xy^2+2x^3y$.<br>
> Då är $U=xy^3+x^3y^2+C_1(y)$ och $U=xy^3+x^3y^2+C_2(x)$.<br>
> Vi har $U=xy^3+x^3y^2+C$ där $C$ är ett tal, t.ex. $C=0$.<br>
> **Svar:** T.ex. $U=xy^3+x^3y^2$

### Potentialformeln
Om $\bar F$ är ett konservativt vektorfält med potential $U$, och $\gamma$ är en riktad kurva från $(x_0,y_0)$ till $(x_1,y_1)$, så är

$$\int_\gamma\bar F\cdot d\bar r=U(x_1,y_1)-U(x_0,y_0)$$

> **Härledning:**
> Vi tar ett konservativt vektorfält $\bar F=\nabla U=\left(\frac\partial{\partial x}U,\frac\partial{\partial y}U\right)$ och en kurva $\gamma$ från $(x_0,y_0)$ till $(x_1,y_1)$.
> $\gamma$ kan parametriseras som $\bar r(t)=(x(t),y(t)),\ t:a\to b$ vilket ger $d\bar r=(\dot x,\dot y)dt$
> Kurvintegralen blir
> 
> $$\int_\gamma\bar F\cdot d\bar r=\int_a^b\left(\frac\partial{\partial x}U,\frac\partial{\partial y}U\right)\cdot(\dot x,\dot y)dt=\int_a^b\left(\frac{\partial U}{\partial x}\dot x+\frac{\partial U}{\partial y}\dot y\right)dt\\=\int_a^b\frac d{dt}U(x(t),y(t))dt=\left[U(x(t),y(t))\right]_a^b=U(x(b),y(b))-U(x(a),y(a))\\=U(x_1,y_1)-U(x_0,y_0)$$
> 
> *Notera att kurvintegralens värde alltså är oberoende av kurvans form, utan bara beror på start- och slutpunkterna.*

> **Övning:**
> Det konservativa fältet $\bar F=(2x-y,-x)$ har potentialen $U=x^2-xy$. Bestäm $\int_\gamma\bar F\cdot d\bar r$ för kurvorna nedan.<br>
> a) En kurva från $(1,2)$ till $(4,6)$.<br>
> Vi vet att $\int_\gamma\bar F\cdot d\bar r=U(4,6)-U(1,2)=-7$<br>
> b) En kurva från $(4,6)$ till $(1,2)$.<br>
> $\int_\gamma\bar F\cdot d\bar r=U(1,2)-U(4,6)=7$<br>
> c) Ett cirkelvarv.<br>
> $\int_\gamma\bar F\cdot d\bar r=U(x_0,y_0)-U(x_0,y_0)=0$ (då start- och slutpunkterna är desamma, t.ex. $(x_0,y_0)$)

> **Exempel:** Beräkna kurvintegralen $\int_\gamma(y^3+3x^2y^2)dx+(3xy^2+2x^3y)dy$ där $\gamma$ är kvartscirkelbågen från $(0,-2)$ till $(-2,0)$ med medelpunkt i origo.<br>
> Enligt tidigare exempel är vektorfältet $\bar F=\nabla U$ där $U=xy^3+x^3y^2$ är dess potential.<br>
> Alltså
> 
> $$\int_\gamma\bar F\cdot d\bar r=U(-2,0)-U(0,-2)=0$$
> 
> **Svar:** $0$

### Villkor för konservativt fält
Ett nödvändigt villkor för att ett kontinuerligt deriverbart vektorfält är konservativt är att dess jakobian är symmetrisk, dvs.

$$\bar F\text{ konservativt}\implies\text{jakobianen }\frac{\partial\bar F}{\partial\bar r}\text{ är symmetrisk}$$

> **Obs!**<br>
> Om vektorfältets definitionsområde dessutom är *enkelt sammanhängande* gäller även det omvända.

> **Bevis:** Om $\bar F$ är konservativt så gäller att $\bar F=\nabla U=(U_x',U_y')$, och eftersom $U_{xy}''=U_{yx}''$ är då
> 
> $$\frac{\partial\bar F}{\partial(x,y)}=\frac{\partial(U_x',U_y')}{\partial(x,y)}=\begin{pmatrix}U_{xx}''&U_{xy}''\\U_{yx}''&U_{yy}''\end{pmatrix}$$
> 
> symmetrisk.

> **Övning:** Undersök vilka vektorfält som är konservativa med hjälp av funktionalmatrisen (jakobianen):<br>
> a) $\bar F=(2x\ln y,x^2/y)$ i området $\{(x,y):y\gt0\}$<br>
> Vi beräknar $\frac{\partial\bar F}{\partial(x,y)}=\begin{pmatrix}2\ln y&\frac{2x}y\\\frac{2x}y&-\frac{x^2}{y^2}\end{pmatrix}$. Området är också enkelt sammanhängande. $\therefore$ Konservativt fält
> 
> b) $\bar F=(x\ln(x^2+y^2),y\ln(x^2+y^2))$ i området $\{(x,y):(x,y)\neq(0,0)\}$<br>
> Inte enkelt sammanhängande$\implies$ingen slutsats.
> 
> c) $\bar F=(2xy,x^2+2yz,y^2-2z$ i hela $\mathbb R^3$.<br>
> $\frac{\partial\bar F}{\partial(x,y,z)}=\begin{pmatrix}*&2x&0\\2x&*&2y\\0&2y&*\end{pmatrix}$<br>
> Matrisen är symmetrisk, och området är enkelt sammanhängande$\implies$fältet är konservativt
> 
> d) $\bar F=(2xy,x^2+2yz,y^2-2z)$ i området $\{(x,y,z):1\lt x^2+y^2\}$.<br>
> Området är hela $\mathbb R^3$, *minus* en cylinder.<br>
> Jakobianen är symmetrisk (uppgift c), men området är *inte* enkelt sammanhängande.<br>
> **Trots detta är vektorfältet konservativt, eftersom vi vet att det är konservativt i hela $\mathbb R^3$.**

> **Exempel:** Beräkna $\int_\gamma2xydx+(x^2+2yz)dy+(y^2-2z)dz$ där $\gamma$ är kurvan $\bar r(t)=(\cos t,\sin t,t)$ från $(1,0,0)$ till $(-1,0,\pi)$.<br>
> Vi vet från tidigare att detta vektorfält är konservativt, dvs. $\bar F=\nabla U$.<br>
> $\frac\partial{\partial x}U=2xy,\ \frac\partial{\partial y}U=x^2+2yz,\ \frac\partial{\partial z}U=y^2-2z$<br>
> $\implies U=x^2y+C_1(y,z)=x^2y+y^2z+C_2(x,z)=y^2z-z^2+C_3(x,y)\\=x^2y+y^2z-z^2+C$<br>
> $\int_\gamma(2xy,x^2+2yz,y^2-2z)\cdot d\bar r=U(-1,0,\pi)-U(1,0,0)=-\pi^2$<br>
> **Svar:** $-\pi^2$

> **Exempel:** Beräkna $\int_\gamma(3y+2\sin(2x-y))dx+(3x-\sin(2x-y))dy$ längs parabeln $y=2x^2$ från $(0,0)$ till $(1,2)$.<br>
> $\int_\gamma(3y+2\sin(2x-y),3x-\sin(2x-y))\cdot(dx,dy)$<br>
> Först undersöker vi om $\bar F$ är konservativt, genom att beräkna jakobianen:
> 
> $$\frac{\partial\bar F}{\partial(x,y)}=\begin{pmatrix}4\cos(2x-y)&3-2\cos(2x-y)\\3-2\cos(2x-y)&\cos(2x-y)\end{pmatrix}$$
> 
> Jakobianen är alltså symmetrisk. $\bar F$ är definierat i hela $\mathbb R^2$ (som är ett enkelt sammanhängande.<br>
> $\implies$ **Vektorfältet är konservativt.**
> 
> Vi kan nu beräkna integralen som ändringen i potential.<br>
> I detta fall väljer vi dock att istället *byta kurva* (ok eftersom fältet är konservativt) till:
> 
> $$\gamma^*:(x,y)=\bar r(t)=(t,2t),\ t:0\to1$$
> 
> Vi beräknar sedan $\int_\gamma\bar F\cdot d\bar r=\int_{\gamma^*}\bar F\cdot d\bar r=\int_0^1\bar F(\bar r(t))\cdot\frac{d\bar r}{dt}dt\\=\int_0^1(6t+2\sin(2t-2t),3t-\sin(2t-2t))\cdot(1,2)dt=\int_0^1(6t,3t)\cdot(1,2)dt=\int_0^112tdt\\=[6t^2]_0^1=6$
> 
> **Svar:** $6$

> **Sammanfattning:**
> För konservativa vektorfält i något område gäller att
> 
> 1. Kurvan $\gamma$ i området påverkar inte $\int_\gamma\bar F\cdot d\bar r$. Kurvintegralen beror endast på start- och slutpunkt.
> 2. $\oint_\gamma\bar F\cdot d\bar r=0$ (*integral över sluten kurva*) för alla slutna kurvor $\gamma$ i området.
> 3. Jakobianen $\frac{\partial\bar F}{\partial\bar x}$ är symmetrisk i området.
> 
> Dessa 3 är ekvivalenta för sammanhängande områden, utom $2\implies3$.
> $2\iff3$ endast om området är *enkelt* sammanhängande.

## Föreläsning 11
### Kvadratkomplettering
> **Kvadratisk form:** Ett andragradsuttryck som bara innehåller andragradstermer.

En kvadratisk form kan skrivas som en summa av kvadrater med kvadratkomplettering:<br>
$2x^2-2xy+2y^2-2yz+z^2=2(x-\frac y2)^2-2\frac {y^2}{2^2}+2y^2-2yz+z^2\\=2(x-\frac y2)^2+\frac{3y^2}2-2yz+z^2=2(x-\frac y2)^2+\frac 32(y-\frac23z)^2-\frac23z^2+z^2\\=2(x-\frac y2)^2+\frac 32(y-\frac{2z}3)^2+\frac{z^2}3$

#### Tecken
En kvadratisk form i variablerna $x_1,\dots,x_n$ sägs vara...

* **Positivt definit** om den antar positiva värden
* **Positivt semidefinit** om den antar ickenegativa värden
* **Indefinit** om den antar båda positiva och negativa värden
* **Negativt semidefinit** om den antar ickepositiva värden
* **Negativt definit** om den antar negativa värden

...för alla $\bar x\neq\bar0$.

### Kvadratisk approximation
#### En variabel
Två gånger differentierbara funktioner (dvs. funktion och dess derivata är båda differentierbara) i en punkt approximeras väl av kvadratiska funktioner:

$$f(a+h)=(\text{kvadratisk funktion av }h)+o(h^2)$$

> **Litet ordo** $f(x)\in o(g(x))$ när $x\to n$ betyder att $f\leq Cg$ där, för någon konstant $C$.<br>
> **Stort ordo:** $f(x)\in\mathcal O(g(x))$ betyder att $f$ *växer högst lika snabbt som* $g$.<br>
> ***För en god kvadratisk approximation ska det gälla att $o(h^2)$-termen $\leq Ch^2$ när $h\to0$.***

För att uppfylla detta krav måste approximationen $f(a+h)=a_0+a_1h+a_2h^2+o(h^2)$ uppfylla följande

$$a_0=f(a)\\a_1=\lim_{h\to0}\frac{f(a+h)-f(a)-a_2h^2-o(h^2)}h=f'(a)\\a_2=\lim_{h\to0}\frac{f(a+h)-f(a)-f'(a)h-o(h^2)}{h^2}=\{\text{L'Hopital}\}=\lim_{h\to0}\frac{f'(a+h)-f'(a)}{2h}=\frac12f''(a)$$

För att få $\frac{o(h^2)}{h^2}\to0$ när $h\to0$ måste den kvadratiska approximationen alltså ha följande form:

$$f(a+h)\approx f(a)+f'(a)h+\frac12f''(a)h^2$$

> **Övning:** Bestäm den kvadratiska approximationen i $x=1$ av $f(x)=2\sqrt x$.<br>
> $f(1+h)\approx f(1)+f'(1)h+\frac12f''(1)h^2=2+h-\frac12h^2$

#### Två variabler
En funktion $f(x,y)$ är två gånger differentierbar i $(a,b)$ om $f(x,y),f_x'(x,y),f_y'(x,y)$ är differentierbara i punkten. En sådan funktion kan approximeras väl av en kvadratisk funktion:

$$f(a+h,b+k)=(\text{kvadratisk funktion av }h,k)+o(r^2)$$

där $\frac{o(r^2)}{r^2}\to0$ när $r\to0$ och $r=|(h,k)|$.

> Feltermen i linjära approximationer är alltså $o(r)=a_3h^2+a_4hk+a_5k^2+o(r^2)$.

En funktion $f(x,y)$ approximeras kvadratiskt kring $(x,y)=(a,b)$ av dess taylorpolynom av grad 2.

$$f(a+h,b+k)\approx f(a,b)+\frac{\partial f}{\partial x}(a,b)h+\frac{\partial f}{\partial y}k\\+\frac12\left(\frac{\partial^2f}{\partial x^2}(a,b)h^2+\frac{\partial^2f}{\partial x\partial y}(a,b)hk+\frac{\partial^2f}{\partial y\partial x}(a,b)hk+\frac{\partial^2f}{\partial y^2}(a,b)k^2\right)$$
> *Obs! Kom ihåg att då $f$ är två gånger kontinuerligt deriverbar är $\frac{\partial f}{\partial x\partial y}=\frac{\partial f}{\partial y\partial x}$.*

> **Exempel:** Bestäm den kvadratiska approximationen i $(2,4)$ av $f(x,y)=e^{x^2-y}$.<br>
> $f(2+h,4+k)\approx f(2,4)+\frac{\partial f}{\partial x}(2,4)h+\frac{\partial f}{\partial y}(2,4)k\\+\frac12\left(\frac{\partial^2f}{\partial x^2}(a,b)h^2+\frac{\partial f^2}{\partial x\partial y}(a,b)hk+\frac{\partial^2f}{\partial y\partial x}(a,b)hk+\frac{\partial^2f}{\partial y^2}(a,b)k^2\right)\\=1+4h-k+9h^2-4hk+\frac{k^2}2$

> **Obs! Det räcker att funktionen är *två gånger kontinuerligt deriverbar* i en omgivning, eftersom detta medför att den också är två gånger differentierbar där.**<br>
> Om $f(x,y)$ är två gånger kontinuerligt deriverbar i en omgivning till $(a,b)$ kan feltermen bestämmas:
> 
> $$f(a+h,b+k)=f(a,b)+f_x'(a,b)h+f_y'(a,b)k\\+\frac12f_{xx}''(a,b)h^2+f_{xy}''(a,b)hk+\frac12f_{yy}''(a,b)k^2\\+\ \boxed{\frac12(f_{xx}''(\xi,\eta)-f_{xx}''(a,b))h^2+(f_{xy}''(\xi,\eta)-f_{xy}''(a,b))hk+\frac12(f_{yy}''(\xi,\eta)-f_{yy}''(a,b))k^2}$$
> 
> där $(\xi,\eta)$ ligger på den räta linjen $(a,b)\to(a+h,b+k)$.
> 
> **Observera:**<br>
> När $(h,k)\to\bar0$ kommer feltermen, enligt uttrycket ovan, gå snabbare $\to0$ än övriga termer (*eftersom andraderivatorna är kontinuerliga funktioner och koefficienterna i feltermen därmed alla $\to0$*).<br>
> Dvs. $\frac{o(r^2)}{r^2}\to0$ när $r\to0$.<br>
> Vi kan av detta dra slutsatsen att
> 
> $$\text{2 ggr kontinuerligt deriverbar i en punkt }\implies\text{ 2 ggr differentierbar där}$$

#### Entydighetssatsen
Om en funktion $f(x,y)$ kan skrivas som

$$f(a+h,b+k)=(\text{andragradsfunktion av }h,k)+o(r^2)$$

där $\frac{o(r^2)}{r^2}\to0$ då $r\to0$, så är andragradsfunktionen alltid andra gradens taylorpolynom kring $(a,b)$, *oavsett hur vi har fått fram approximationsformeln*.

> **Exempel:** Ta funktionen $f(x,y)=\ln(1+x+y^2)$.
> Kvadratisk approximation kring $(0,0)$:
> $f(0+h,0+k)=\ln(1+h+k^2)=\{t=h+k^2\}=\ln(1+t)=t-\frac{t^2}2+\mathcal O(t^3)\\=h+k^2-\frac12(h^2+2hk^2+k^4)+\mathcal O(r^3)=\{\text{termerna }hk^2,k^4\text{ är av grad}\geq3\}\\=h+k^2-\frac{h^2}2+\mathcal O(r^3)$
> Entydighetssatsen ger att detta är den kvadratiska approximationen.

> **Övning:** Bestäm taylorutvecklingen av ordning 2 för
> a) $f(x,y)=\cos(x+y)$ kring $(0,0)$
> $f(0+h,0+k)=\cos(h+k)=\{t=h+k\}=\cos(t)=1-\frac12t^2+\mathcal O(t^4)\\=1-\frac12(h+k)^2+\mathcal O(r^3)=1-\frac{h^2}2-hk-\frac{k^2}2+\mathcal O(r^3)$
> 
> b) $f(x,y)=e^{xy}$ kring $(0,2)$
> $f(0+h,2+k)=e^{h(2+k)}=\{t=2h+hk\}=e^t=1+t+\frac{t^2}2+\mathcal O(t^3)\\=1+h(2+k)+\frac{4h^2}2+\frac{4h^2k}2+\frac{h^2k^2}2+\mathcal O(r^3)=\{\text{termer av ordning }\geq3\text{ låts ingå i }\mathcal O(r^3)\}\\=1+2h+kh+2h^2+\mathcal O(r^3)$

### Taylors formel i matrisform
$$f(a+h,b+k)=f(a,b)+\nabla f\cdot\begin{pmatrix}h\\k\end{pmatrix}+\frac12\begin{pmatrix}h&k\end{pmatrix}\begin{pmatrix}f_{xx}''(a,b)&f_{yx}''(a,b)\\f_{xy}''(a,b)&f_{yy}''(a,b)\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}$$

Matrisen med andraderivator kallas för *hessianen* och betecknas $H_f(a,b)$.

> **Övning:**
> Skriv i matrisform
> 
> $$f(1+h,2+k)=4+\begin{pmatrix}-1&2\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+\frac12\begin{pmatrix}h&k\end{pmatrix}\begin{pmatrix}-3&-4\\-4&2\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+o(r^2)$$
> 
> Skriv utan matriser
> 
> $$f(0+h,0+k)=3+\begin{pmatrix}2&-1\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+\frac12\begin{pmatrix}h&k\end{pmatrix}\begin{pmatrix}3&1\\1&-2\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+o(r^2)\\=3+2h-k+\frac32h^2+hk-k^2+o(r^2)$$

#### I tre variabler
$$f(a+h,b+k,c+l)=f(a,b,c)+\nabla f(a,b,c)\cdot\begin{pmatrix}h\\k\\l\end{pmatrix}\\+\frac12(h,k,l)\begin{pmatrix}f_{xx}''(a,b,c)&f_{yx}''(a,b,c)&f_{zx}''(a,b,c)\\f_{xy}''(a,b,c)&f_{yy}''(a,b,c)&f_{zy}''(a,b,c)\\f_{xz}''(a,b,c)&f_{yz}''(a,b,c)&f_{zz}''(a,b,c)\end{pmatrix}\begin{pmatrix}h\\k\\l\end{pmatrix}+o(r^2)$$

## Föreläsning 12
### Implicita funktioner
Implicita funktioner definieras som lösningar till en eller flera ekvationer.

En kurva $f(x,y)=0$ definierar lokalt en funktion $y=y(x)$ kring en punkt $(x,y)=(a,b)$ på kurvan, om det finns en omgivning inom vilken kurvan, för varje värde på $x$, har ett unikt $y$.

> **Implicita funktionssatsen:**
> Om $f(x,y)$ är kontinuerligt deriverbar definierar nivåkurvan $f(x,y)=0$ lokalt värdet $y$ som en kontinuerligt deriverbar funktion av $x$ om
> 
> $$\frac{\partial f}{\partial y}(a,b)\neq0$$
> 
> Detta eftersom nivåkurvans tangentlinje inte får vara lodrät.

> **Övning:** Undersök om $e^{xy}+x+y=2$ i en omgivning till $(1,0)$ definierar en kontinuerligt deriverbar funktion $y=y(x)$.
> Låt $f(x,y)=e^{xy}+x+y-2$. Kurvan beskrivs då av $f(x,y)=0$.
> $\frac{\partial f}{\partial y}(1,0)=xe^{xy}+1=2\neq0$

> **Övning:** Bestäm $y'(1)$ för funktionen ovan.
> $\frac\partial{\partial x}(e^{xy(x)}+x+y(x))=\frac\partial{\partial x}2$
> $(y(x)+xy'(x))e^{xy(x)}+1+y'(x)=0$
> Insättning av $(x,y)=(1,0)$ ger $y'(1)=-\frac12$

Notera att den implicit definierade funktionen $y=y(x)$ bara är garanterad att finns *i en omgivning*, dvs. inte globalt.

Om $\frac{\partial f}{\partial y}(a,b)=0$ *kan ingen slutsats dras* om huruvida en kontinuerligt deriverbar $y(x)$ lokalt existerar.

#### Lamberts W-funktion
$$W(x)e^{W(x)}=x,\text{ för }x\gt-\frac1e$$

> **Exempel:** Visa att $W(x)$ är en kontinuerligt deriverbar funktion.
> Låt $f(x,w)=we^w-x$. Kurvan ges då av $f(x,w)=0$.
> Om (1) $f$ kontinuerligt deriverbar & (2) $\frac{\partial f}{\partial w}\neq0\implies w=W(x)$ kontinuerligt deriverbar (lokalt).
> (1) $f_x'=-1,f_w'=e^w+we^w\implies f$ är kontinuerligt deriverbar
> (2) $\frac{\partial f}{\partial w}=(1+w)e^w\neq0$ om $w\neq-1\implies x\neq-\frac1e$
> Alltså är $W(x)$ en kontinuerligt deriverbar funktion.

> **Övning:** Använd W-funktionen för att lösa
> a) $xe^x=2\iff W(2)e^{W(2)}=2\iff x=W(2)$
> b) $x\ln(x)=1.25\iff te^t=1.25\iff t=W(1.25)\iff x=e^{W(1.25)}$
> c) $x^x=4\iff x\ln x=\ln4\iff te^t=\ln4\iff{t=W(\ln4)\iff e^{W(\ln4)}}$
> d) $x2^x=5\iff \ln(2)xe^{x\ln2}=5\ln(2)\iff x=\frac{W(5\ln2)}{\ln2}$

> **Exempel:** Beräkna ett approximativt värde av $W(0.01)$.
> Vi söker lösning till $W(0.01)e^{W(0.01)}=0.01$.
> Vi vet $W(0)=0$ och gör nu linjär approximation.
> $W(0+h)\approx W(0)+W'(0)h=W'(0)h$
> Låt $f(x,w)=we^w-x$. Kurvan $w=W(x)$ ges av $f(x,w)=0$.
> Vi deriverar m.a.p. $x$: $W(x)e^{W(x)}+W'(x)e^{W(x)}-1=0\implies W'(0)=1$
> **Svar:** $W(0+0.01)\approx0.01$

#### Samband mellan 3 variabler
Om $f$ är kontinuerligt deriverbar så definierar ekvationen $f(x,y,z)=0$ en kontinuerligt deriverbar funktion $z(x,y)$ lokalt kring $(a,b,c)$ om

$$\frac{\partial f}{\partial z}(a,b,c)\neq0$$

> **Exempel:** Visa att sambandet $3xyz-z^3=0$ definierar $z=z(x,y)$ som en kontinuerligt deriverbar funktion kring $(1,3,2)$. Bestäm $z_x'(1,3)$ och $z_y'(1,3)$.
> Låt $f(x,y,z)=3xyz-z^3=0$. Funktionen är kontinuerligt deriverbar.
> $\frac{\partial f}{\partial z}(1,3,2)=3xy-3z^2=9-12=-3\neq0\\\implies$Lokalt ges alltså $z$ av en kontinuerligt deriverbar funktion $z(x,y)$.
> 
> Vi deriverar det implicita sambandet m.a.p. $x$:
> $3yz(x,y)+3xyz_x'(x,y)-3(z(x,y))^2z_x'(x,y)=0\\18+9z'(1,3)-12z'(1,3)=0\implies z'_x(1,3)=6$
> 
> Och gör motsvarande för $y$:
> $3xz(x,y)+3xyz_y'(x,y)-3(z(1,3))^2z_y'(1,3)=0\\6+9z_y'(1,3)-12z_y'(1,3)=0\implies z_y'(1,3)=2$
> **Svar:** 6 resp. 2

### Lösningar till linjära ekvationssystem
Ett kvadratiskt system har exakt en lösning omm $\det A\neq0$.

$$\begin{vmatrix}1&0&3\\2&2&1\\2&1&4\end{vmatrix}=1\begin{vmatrix}2&1\\1&4\end{vmatrix}+3\begin{vmatrix}2&2\\2&1\end{vmatrix}=7-6=1\neq0\iff\text{exakt en lösning}$$

I denna kurs är vi intresserade av ekvationssystem där vi har fler obekanta än ekvationer.

Ett linjärt ekvationssystem med $m$ ekvationer och $m+n$ obekanta

$$\begin{cases}a_{11}x_1+\cdots+a_{1m}x_m&+&b_{11}y_1+\cdots+b_{1n}y_n&=&c_1\\a_{21}x_1+\cdots+a_{2m}x_m&+&b_{21}y_1+\cdots+b_{2n}y_n&=&c_2\\\cdots\\a_{m1}x_1+\cdots+a_{mm}x_m&+&b_{m1}y_1+\cdots+b_{mn}y_n&=&c_m\end{cases}$$

har en parameterlösning $\bar x=\bar x(\bar y)$, dvs. en parameterlösning för $x_1,\dots,x_m$ där $y_1,\dots,y_n$ är parametrar, **omm**

$$\begin{vmatrix}a_{11}&a_{12}&\cdots&a_{1m}\\a_{21}&a_{22}&\cdots&a_{2m}\\\vdots&\vdots&\ddots&\vdots\\a_{m1}&a_{m2}&\cdots&a_{mm}\end{vmatrix}\neq0$$

> **Övning:**
> Ange ett villkor för om systemet
> 
> $$\begin{cases}\begin{matrix*}[l]2x&+y&-z&+2u&-5v&+3w=0\\-x&+3y&+z&-u&+3v&+w=0\\2x&-y&+2z&&+v&+2w=0\end{matrix*}\end{cases}$$
> 
> har en parameterlösning där $\bar t=(y,u,v)$ är parametrar.
> 
> Vi tänker oss att vi flyttar parameter-variablerna till höger om likhetstecknen. Koefficienterna framför våra sökta variabler ställs upp i en matris. Vi kan lösa ut de sökta variablerna $x,z,w$ som funktioner av $y,u,v$ om determinanten är nollskild:
> 
> $$\begin{vmatrix}2&-1&3\\-1&1&1\\2&2&2\end{vmatrix}\neq0$$
> 
> **Svar:** Determinanten blir $2\begin{vmatrix}1&1\\2&2\end{vmatrix}+\begin{vmatrix}-1&1\\2&2\end{vmatrix}+3\begin{vmatrix}-1&1\\2&2\end{vmatrix}=-16\implies$Möjligt!

### Implicita funktionssatsen
#### Två samband mellan tre variabler
Om vi har sambanden $\begin{cases}f(x,y,z)=0\\g(x,y,z)=0\end{cases}$ och dessa är kontinuerligt deriverbara,
så ges $x$ och $y$ som kontinuerligt deriverbara funktioner av $z$ kring någon punkt (som uppfyller sambanden) om

$$\det\begin{bmatrix}\frac{\partial(f,g)}{\partial(x,y)}(a,b,c)\end{bmatrix}\neq0$$

> **Härledning:**<br>
> Kring en punkt $(a,b,c)$ gäller enligt linjär approximation:<br>
> $\begin{cases}f(a,b,c)+f_x'(a,b,c)h+f_y'(a,b,c)k+f_z'(a,b,c)l+\text{fel}=0\\g(a,b,c)+g_x'(a,b,c)h+g_y'(a,b,c)k+g_z'(a,b,c)l+\text{fel}=0\end{cases}$
> 
> Enligt vad vi såg tidigare gäller att $h,k$ kan lösas ut som funktioner av $l$ om
> 
> $$\begin{vmatrix}f_x'(a,b,c)&f_y'(a,b,c)\\g_x'(a,b,c)&g_y'(a,b,c)\end{vmatrix}\neq0$$

> **Exempel:** Visa att sambanden $\begin{cases}2e^x-e^y-e^z=0\\xyz-1=0\end{cases}$ definierar kontinuerligt deriverbara funktioner $x=x(z),y=y(z)$ kring $(1,1,1)$.
> 
> Sambanden kan skrivas som som $f=0,g=0$ där dessa är kontinuerligt deriverbara. Med linjär approx.:<br>
> $\begin{cases}f(1,1,1)+f_x'(1,1,1)h+f_y'(1,1,1)k+f_z'(1,1,1)l+\text{fel}=0\\g(1,1,1)+g_x'(1,1,1)h+g_y'(1,1,1)k+g_z'(1,1,1)l+\text{fel}=0\end{cases}$<br>
> Vi beräknar $\begin{vmatrix}f_x'(1,1,1)&f_y'(1,1,1)\\g_x'(1,1,1)&g_y'(1,1,1)\end{vmatrix}=\begin{vmatrix}2e&-e\\1&1\end{vmatrix}=3e\neq0\\\implies x(z),y(z)$ kontinuerligt deriverbara funktioner av $z$.

#### Allmänna fallet
Om vi har sambanden $\begin{cases}f_1(x_1,\dots,x_m,y_1,\dots,y_n)=0\\\cdots\\ f_m(x_1,\dots,x_m,y_1,\dots,y_n)=0\end{cases}$ där $f_1,\dots,f_m$ är kontinuerligt deriverbara, så definieras $x_1,\dots,x_m$ som kontinuerligt deriverbara funktioner av $y_1,\dots,y_n$ lokalt kring en punkt $(a_1,\dots,a_m,b_1,\dots,b_n)$, som uppfyller sambanden, om

$$\det{\left(\frac{\partial(f_1,\dots,f_m)}{\partial(x_1,\dots,x_m)}(a_1,\dots,a_m,b_1,\dots,b_n)\right)}\neq0$$


### Lokal inverterbarhet
En funktion $f$ är *lokalt inverterbar* om en inversfunktion existerar när definitionsmängden begränsas till en omgivning.

#### Inversa funktionssatsen
En kontinuerligt deriverbar funktion $\bar f$ ser lokalt ut som en linjär avbildning med matrisen $J_{\bar f}$.

Om denna matris är inverterbar, dvs. $\det{J_{\bar f}}\neq0$, så är $\bar f$ *lokalt inverterbar* kring linjäriseringspunkten.

> **Exempel:**
> Systemet $\begin{cases}e^x+xy+e^y=2\\x^3-x+y+y^3=0\end{cases}$ har en lösning $(0,0)$. Visa att det, i en tillräckligt liten omgivning, inte finns någon annan lösning.
> Vi inför $\bar f:\begin{bmatrix}x\\y\end{bmatrix}\mapsto\begin{bmatrix}e^x+xy+e^y\\x^3-x+y+y^3\end{bmatrix}=\begin{bmatrix}u\\v\end{bmatrix}$
> Vi vill att $\bar f$ är lokalt inverterbar kring $(0,0)$.
> Approximering ger ekvationen $(2,0)=\bar f(0+h,0+k)\approx\bar f(0,0)+\frac{\partial(u,v)}{\partial(x,y)}(0,0)\begin{bmatrix}h\\k\end{bmatrix}$
> För att unik lösning ska finnas måste $\begin{vmatrix}e^x+y&x+e^y\\3x^2-1&1+3y^2\end{vmatrix}=\{x=y=0\}=2\neq0$
> Dvs. $(0,0)$ är en unik lösning i någon omgivning.

> **Övning:** Visa att $\bar f:(x,y)\mapsto(xy,\ln\frac xy)$ har en differentierbar lokal invers kring punkten $(1,1)$.
> $\bar f(1+h,1+k)\approx(1,0)+\begin{pmatrix}y&x\\1/x&-\frac{1}{y}\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}$
> Jakobianens determinant är $\begin{vmatrix}1&1\\1&-1\end{vmatrix}=-2\neq0$
> $\implies\bar f$ är lokalt inverterbar kring punkten.

#### Inversfunktionens jakobian
Inversfunktionens jakobian är $(J_f)^{-1}$.

> **Exempel:** Bestäm $\frac{\partial(r,\theta)}{\partial(x,y)}$ för avbildningen $\begin{cases}x=r\cos\theta\\y=r\sin\theta\end{cases}$
> Vi har $J_{f^{-1}}=\begin{pmatrix}\cos\theta&-r\sin\theta\\\sin\theta&r\cos\theta\end{pmatrix}$.
> $\frac{\partial(r,\theta)}{\partial(x,y)}=(J_{f^{-1}})^{-1}=\frac1r\begin{pmatrix}r\cos\theta&r\sin\theta\\-\sin\theta&\cos\theta\end{pmatrix}=\frac1{\sqrt{x^2+y^2}}\begin{pmatrix}x&y\\-\frac y{\sqrt{x^2+y^2}}&\frac x{\sqrt{x^2+y^2}}\end{pmatrix}$

> **Exempel:**<br>
> Ekvationssystemet $\begin{cases}e^x+xy+e^y=2\\x^3-x+y+y^3=0\end{cases}$ som har lösningen $(0,0)$ störs så att vi istället får systemet
> 
> $$\begin{cases}e^x+xy+e^y=2+\epsilon_1\\x^3-x+y+y^3=0+\epsilon_2\end{cases}$$
> 
> Inför $\bar f:\begin{bmatrix}x\\y\end{bmatrix}\mapsto\begin{bmatrix}e^x+xy+e^y\\x^3-x+y+y^3\end{bmatrix}=\begin{bmatrix}u\\v\end{bmatrix}$<br>
> Vi söker $\bar f^{-1}(2+\epsilon_1,0+\epsilon_2)=(x,y)$<br>
> Gör en linjär approximation av inversfunktionen kring $(2,0)$:<br>
> $\bar f^{-1}(2+\epsilon_1,0+\epsilon_2)\approx\bar f^{-1}(2,0)+J_{\bar f^{-1}}(2,0)\begin{bmatrix}\epsilon_1\\\epsilon_2\end{bmatrix}$<br>
> $J_{\bar f^{-1}}(2,0)=(J_{\bar f}(0,0))^{-1}=\{\text{från tidigare}\}=\begin{bmatrix}1&1\\-1&1\end{bmatrix}^{-1}=\frac12\begin{bmatrix}1&-1\\1&1\end{bmatrix}$<br>
> $\bar f^{-1}(2+\epsilon_1,0+\epsilon_2)\approx(0,0)+\frac12\begin{pmatrix}1&-1\\1&1\end{pmatrix}\begin{pmatrix}\epsilon_1\\\epsilon_2\end{pmatrix}=\frac12\begin{pmatrix}\epsilon_1-\epsilon_2\\\epsilon_1+\epsilon_2\end{pmatrix}$


## Föreläsning 13-14
### Extrempunkter
* En **lokal minpunkt** är en punkt $(a,b)$ så att $f(a,b)\leq f(x,y)$ i en *omgivning* till $(a,b)$.
* En **lokal maxpunkt** är en punkt $(a,b)$ så att $f(a,b)\geq f(x,y)$ i en *omgivning* till $(a,b)$.
* En **global minpunkt** är en punkt $(a,b)$ så att $f(a,b)\leq f(x,y)$ i hela *definitionsmängden*.
* En **global maxpunkt** är en punkt $(a,b)$ så att $f(a,b)\geq f(x,y)$ i hela *definitionsmängden*.

### Optimering över kompakta områden
En kontinuerlig funktion $f$ antar alltid ett största och minsta värde i ett kompakt område. Detta kan ske i fyra typer av punkter:

1. *Inre stationära (kritiska) punkter*: $f_{\bar v}'(a,b)=0$ för alla riktningar $\bar v$.
2. *Stationära (kritiska) randpunkter*: $f_{\bar v}'(a,b)=0$ för alla riktningar $\bar v$ som är *parallella med randen*.
3. *Icke-differentierbara punkter*
4. *Singulära randpunkter* och *hörnpunkter*

#### Inre stationära punkter
*Antag $f(x,y)$ är differentierbar.* Funktionen $f(x,y)$ antar lokala min/max *endast* i inre stationära punkter. I dessa punkter gäller att $f_{\bar v}'(a,b)=\nabla f(a,b)\cdot\bar v=0$, vilket medför att $\nabla f(a,b)=(0,0)$.

> **Exempel:** Bestäm alla inre stationära punkter till $f(x,y)=8xy-4x^2y-2xy^2+x^2y^2$.<br>
> Partialderivatorna är<br>
> $f_x'=8y-8xy-2y^2+2xy^2$<br>
> $f_y'=8x-4x^2-4xy+2x^2y$<br>
> Dessa är båda elementära$\implies$kontinuerliga$\implies f$ är differentierbar<br>
> Vi söker punkter där $\nabla f(x,y)=(0,0)$.<br>
> $\begin{cases}8y-8xy-2y^2+2xy^2=0\\8x-4x^2-4xy+2x^2y=0\end{cases}$<br>
> $\iff\begin{cases}2y(4-4x-y+xy)=0\\2x(4-2x-2y+xy)=0\end{cases}$<br>
> Vi har fyra möjligheter:
> 
> ||$y=0$|$4-4x-y+xy=0$|
> |-|-|-|
> |$x=0$|$(0,0)$|$(0,4)$|
> |$4-2x-2y+xy=0$|$(2,0)$|$y=2x\\\implies (x-1)(x-2)=0\\(1,2)\text{ och }(2,4)$|
> 
> **Svar:** $(0,0),(0,4),(2,0),(1,2),(2,4)$ är de inre stationära punkterna. Eftersom $f$ är differentierbar kan min/max bara antas i dessa punkter.

> **Övning:** Bestäm alla inre stationära punkter till $f(x,y)=x^2+y^2-2x-4y+2$.<br>
> $\nabla f=(2x-2,2y-4)$<br>
> Kontinuerliga partialderivator$\implies f$ är differentierbar.<br>
> Stationära punkter är lösningar till $\nabla f=(0,0)$.<br>
> **Svar:** $(1,2)$

> **Övning:** Bestäm alla inre stationära punkter till $f(x,y)=2x^4+y^4-x^2-2y^2$.<br>
> $\nabla f=(8x^3-2x,4y^3-4y)=(0,0)$<br>
> $\begin{cases}2x(4x^2-1)=0\\4y(y^2-1)=0\end{cases}\iff\begin{cases}2x(2x-1)(2x+1)=0\\4y(y-1)(y+1)=0\end{cases}$
> 
> ||$x=0$|$x=-1/2$|$x=1/2$|
> |-|-|-|-|
> |$y=0$|$(0,0)$|$(-1/2,0)$|$(1/2,0)$|
> |$y=-1$|$(0,-1)$|$(-1/2,-1)$|$(1/2,-1)$|
> |$y=1$|$(0,1)$|$(-1/2,1)$|$(1/2,1)$|
> 
> **Svar:** Det finns 9 stationära punkter (se ovan).

#### Klassificering av inre stationära punkter
Den stationära punktens karaktär (lokalt max, min eller ingetdera) avgörs av kvadratformen i 2:a gradens taylorutveckling till funktionen:

$$f(a+h,b+k)=f(a,b)+\frac12\begin{pmatrix}h&k\end{pmatrix}\begin{pmatrix}f_{xx}''(a,b)&f_{yx}''(a,b)\\f_{xy}''(a,b)&f_{yy}''(a,b)\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+\text{felterm}$$

Observera att förstagradstermer saknas eftersom partialderivatorna $=0$.

* Negativt definit$\implies$lokal maxpunkt
* Positivt definit$\implies$lokal minpunkt
* Indefinit$\implies$sadelpunkt (varken max/min)
* Semidefinit$\implies$ingen slutsats

> **Exempel:** Bestäm alla lokala extrempunkter till $f(x,y)=x^3+3xy^2-15x-12y$.<br>
> Lokala extrempunkter kan bara förekomma i stationära punkter, dvs. $\nabla f=(0,0)$<br>
> $\nabla f=(3x^2+3y^2-15,6xy-12)=(0,0)$<br>
> $\begin{cases}x^2+y^2-5=0\\xy-2=0\end{cases}\implies\{y=\frac2x\text{ eftersom }x\neq0\}\implies x^2+\frac4{x^2}-5=0\\\implies x=\pm1\text{ eller }x=\pm2$<br>
> Stationära punkter: $(1,2),(-1,-2),(2,1),(-2,-1)$.<br>
> Vi väljer att undersöka $(2,1)$:<br>
> Taylorutveckling ger $f(2+h,1+k)=f(2,1)+\frac12\begin{pmatrix}h&k\end{pmatrix}\begin{pmatrix}6x&6y\\6y&6x\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+o(r^2)$<br>
> Andragradstermerna ("dominerande"):<br>
> $\frac12(12h^2+12hk+12k^2)=\{\text{kvadratkomplettering}\}=6(h+\frac k2)^2+\frac{9k^2}2$<br>
> Positivt definit och alltså är $(2,1)$ en *lokal minimipunkt*.<br>
> Motsvarande kan göras för övriga stationära punkter...

### Stationära punkter på en kurva
Antag att $f(x,y)$ är differentierbar och att vi har en kurva utan singulära punkter. På kurvan antar $f$ lokala max- och minvärden endast i punkter $(a,b)$ där $f_{\bar v}'(a,b)=0$ för alla riktningar $\bar v$ parallella med kurvan i punkten.

#### Lagrangevillkoret
I en stationär punkt $(a,b)$ till $f(x,y)$ på kurvan $g(x,y)=0$ gäller att

$$\nabla f(a,b)\parallel\nabla g(a,b)$$

> **Motivering:**<br>
> Vi väljer en punkt $(a,b)$ på kurvan $g(x,y)=0$.<br>
> Om $\bar v$ är en vektor parallell med kurvan i denna punkt gäller att $\nabla g(a,b)\cdot\bar v=0$, dvs. *de är vinkelräta*.<br>
> Eftersom $(a,b)$ är en stationär punkt på kurvan är $f_{\bar v}'(a,b)=\nabla f(a,b)\cdot\bar v=0$, dvs. *även de är vinkelräta*.<br>
> Eftersom både $\nabla g(a,b)$ och $\nabla f(a,b)$ är vinkelräta mot $\bar v$, måste $\nabla f(a,b)=\lambda\nabla g(a,b)$.

> **Exempel:** Bestäm alla stationära punkter till $f(x,y)=xy$ på ellipsen $x^2+3y^2=1$<br>
> Inför $g(x,y)=x^2+3y^2-1$. Då ges ellipsen av $g(x,y)=0$.<br>
> Enligt lagrangevillkoret måste $\nabla f(x,y)\parallel\nabla g(x,y)$ för att $(x,y)$ ska vara en stationär punkt.<br>
> Vi har $\nabla f=(y,x)$ och $\nabla g=(2x,6y)$.<br>
> Att $\nabla f\parallel\nabla g\iff\begin{vmatrix}y&x\\2x&6y\end{vmatrix}=0$<br>
> Vi får $0=6y^2-2x^2=2(3y^2-x^2)=2(\sqrt3y-x)(\sqrt3y+x)$<br>
> Två fall: $\sqrt3y-x=0$ eller $\sqrt3y+x=0$<br>
> I första fallet: $x=\sqrt3y\implies6y^2-1=0\implies\begin{cases}x=\frac1{\sqrt2},&y=\frac1{\sqrt6}\\x=-\frac1{\sqrt2},&y=-\frac1{\sqrt6}\end{cases}$<br>
> I andra fallet: $x=-\sqrt3y\implies6y^2-1=0\implies\begin{cases}x=-\frac1{\sqrt2},&y=\frac1{\sqrt6}\\x=\frac1{\sqrt2},&y=-\frac1{\sqrt6}\end{cases}$

#### Lagrangefunktionen
Vi inför Lagrangefunktionen $L(x,y,\lambda)=f(x,y)-\lambda g(x,y)$.<br>
De stationära punkterna till $f(x,y)$ på kurvan $g(x,y)=0$ ges då av de stationära punkterna till $L$. Detta kan ses som:

$$\frac\partial{\partial x}L=\frac\partial{\partial x}f-\lambda\frac\partial{\partial x}g=0\\\frac\partial{\partial y}L=\frac\partial{\partial y}f-\lambda\frac\partial{\partial y}g=0\\\frac\partial{\partial\lambda}L=0-g(x,y)=0$$

> **Exempel:** Bestäm alla stationära punkter till $f(x,y)=x^2+y^2$ på $x^4+y^4=1$.<br>
> Vi inför $g(x,y)=x^4-y^4-1=0$.<br>
> Vi definierar $L(x,y,\lambda)=f(x,y)-\lambda g(x,y)=x^2+y^2-\lambda(x^4+y^4-1)$<br>
> Vi söker punkter där $\nabla L=(0,0,0)$.<br>
> $\nabla L=(2x(1-2\lambda x^2),2y(1-2\lambda y^2),1-x^4-y^4)=(0,0,0)$
> 
> ||$x=0$|$1=2\lambda x^2$|
> |-|-|-|
> |$y=0$|Uppfyller ej<br>$1-x^4-y^4=0$|$(-1,0),(1,0)$|
> |$1=2\lambda y^2$|$(0,-1),(0,1)$|4 möjliga punkter:<br>$(\pm\sqrt[4]{1/2},\pm\sqrt[4]{1/2})$|

> **Övning:** Skriv upp Lagrangefunktionen till följande problem:<br>
> a) Bestäm stationära punkter till $f(x,y)=xy$ på kurvan $2x^2+y^2=1$.<br>
> $L(x,y,\lambda)=xy-\lambda(2x^2+y^2-1)$
> 
> b) Bestäm stationära punkter till $f(x,y)=e^{x-y}$ på kurvan $3x+4y=1$.<br>
> $L(x,y,\lambda)=e^{x-y}-\lambda(3x+4y-1)$
> 
> c) Vilka punkter på ellipsen $5x^2+4xy+2y^2=6$ ligger närmast origo?<br>
> Vi vill minimera $|(x-0,y-0)|=\sqrt{x^2+y^2}$ under förutsättning att $5x^2+4xy+2y^2=6$.<br>
> Dvs. $L(x,y,\lambda)=\sqrt{x^2+y^2}-\lambda(5x^2+4xy+2y^2-6)$

#### Parametrisering av kurvan
Om randkurvan kan parametriseras $(x,y)=(x(t),y(t))$ så uppfyller de stationära randpunkterna

$$\frac d{dt}f(x(t),y(t))=0$$

> **Exempel:** Sök stationära punkter till $f(x,y)=x^2+2y^2-x+1$ på enhetscirkeln.<br>
> Enhetscirkeln kan parametriseras som $(x,y)=(\cos t,\sin t),t:0\to2\pi$<br>
> $f(x(t),y(t))=\cos^2t+2\sin^2t-\cos t+1=2+\sin^2t-\cos t=3-\cos^2t-\cos t$<br>
> Vi söker nu lokala max/min:<br>
> $\frac d{dt}f(x(t),y(t))=2\cos t\sin t+\sin t=2\sin(t)(\cos t+1/2)=0$<br>
> $\implies\sin t=0\text{ eller }\cos t=-\frac12$<br>
> Första fallet ger $t=0,t=\pi\implies(1,0),(-1,0)$<br>
> Andra fallet ger $x=-\frac12,y=\pm\frac{\sqrt3}2\implies(-\frac12,\frac{\sqrt3}2),(-\frac12,-\frac{\sqrt3}2)$

> **Exempel:** Bestäm alla stationära randpunkter till $f(x,y)=2-3x^2+y^2-3\ln(1+x^2+y^2)$ på enhetscirkeln.<br>
> På enhetscirkeln gäller $f(x,y)=3-4x^2-3\ln2$<br>
> Parametrisering av enhetscirkeln $(x,y)=(\cos t,\sin t),t:0\to2\pi$<br>
> Vi får $f(x(t),y(t))=3-4\cos^2t-3\ln2$<br>
> Vi söker nu stationära punkter till $f$ på enhetscirkeln, dvs. punkter där<br>
> $0=\frac d{dt}f(x(t),y(t))=8\cos t\sin t$<br>
> Vi får punkterna $(0,1),(0,-1),(1,0),(-1,0)$.

### Sammanfattande exempel
> **Exempel:** Bestäm det största och minsta värde som $f(x,y)=2x^2+xy+3y^2$ antar i kvadraten
> $-1\leq x\leq1,-1\leq y\leq1$.<br>
> Observera att detta är ett kompakt område, och att $f(x,y)$ är kontinuerlig$\implies f$ har min- och max-värden i området.<br>
> De punkter vi behöver undersöka:
> 
> 1. Inre stationära punkter: $\nabla f=(0,0)$<br>
> $\nabla f=(4x+y,x+6y)=(0,0)\implies(0,0)$
> 2. Stationära randpunkter: Punkter där Lagrangevillkoret är uppfyllt<br>
> Randen består av 4 linjestycken:<br>
> (1) $(x,y)=(1,t),-1\leq t\leq1\implies\frac d{dt}f(x(t),y(t))=1+6t=0\implies(1,-\frac16)$<br>
> (2) $g(x,y)=y-1=0,\nabla f\parallel\nabla g\implies0=\begin{vmatrix}4x+y&x+6y\\0&1\end{vmatrix}=4x+y=4x+1\\\implies(-\frac14,1)$<br>
> (3) $(x,y)=(-1,t),-1\leq t\leq1\implies\frac d{dt}f(x(t),y(t))=6t-1=0\implies(-1,\frac16)$<br>
> (4) $(x,y)=(t,-1),-1\leq t\leq1\implies\frac d{dt}f(x(t),y(t))=4t-1=0\implies(\frac14,-1)$
> 3. Icke-differentierbara punkter<br>
> Finns inga sådana punkter! $f_x',f_y'$ kontinuerliga$\implies f$ kontinuerligt deriverbar$\implies$ differentierbar
> 4. Hörnpunkter & singulära randpunkter: Punkter där randkurvor möts resp. där $\nabla g=(0,0)$.<br>
> Hörnpunkterna $(-1,-1),(-1,1),(1,-1),(1,1)$ är möljliga min/max-punkter.<br>
> Singulära punkter (dvs. $\nabla g=(0,0)$ eller $(\frac{dx}{dt},\frac{dy}{dt})=(0,0)$): Uppkommer inte.
> 
> **Kandidater:** $(0,0),(1,-\frac16),(-\frac14,1),(-1,\frac16),(\frac14,-1),(-1,-1),(-1,1),(1,-1),(1,1)$<br>
> Funktionen maximi- och minimipunkt i området måste finnas bland dessa.<br>
> $f(0,0)=0,f(1,-\frac16)=\frac{23}{12},f(-\frac14,1)=\frac{23}8,f(-1,\frac16)=\frac{23}{12},f(\frac14,-1)=\frac{23}8,f(-1,-1)=6,f(-1,1)=4,f(1,-1)=4,f(1,1)=6$<br>
> **Svar:** Minimivärde 0 och maximivärde 6.

### Optimering över icke-kompakta områden
På ett område som inte är kompakt behöver en kontinuerligt deriverbar funktion inte alltid anta något största/minsta värde.<br>
Detta då randpunkterna inte ingår i området.

> **Exempel:** Bestäm det största och minsta värde som $f(x,y)=xy^2e^{-xy}$ antar i $0\leq x\leq2,y\geq0$.<br>
> Då $f(x,y)\geq0$ i hela området, och $f(0,0)=0$, är funktionens minsta värde 0.<br>
> Något största värde *finns inte* eftersom $f(1/t,t)=\frac1tt^2e^{-\frac1tt}=\frac te\to\infty$ när $t\to\infty$.

## Föreläsning 15
### Optimering i rummet
Ett optimeringsproblem i rummet går ut på att bestämma det största eller minsta värde som en funktion $f(x,y,z)$ antar i ett område i rummet. T.ex. "var i rummet är temperaturen högst".

### Optimering över kompakta områden i rummet
En kontinuerlig funktion $f$ antar alltid ett största och minsta värde i ett kompakt område. Det finns fyra typer av punkter där max/min kan antas för en **differentierbar** funktion:

1. Inre stationära punkter: $\nabla f=(0,0,0)$
2. Stationära randytpunkter: Punkter på randytan där $f_{\hat v}'(a,b,c)=0$ för alla riktningar parallella med randytan.
3. Stationära punkter på skärningen mellan randytor
4. Hörnpunkter och singulära randpunkter

#### Inre stationära punkter
Antag att $f(x,y,z)$ är differentierbar. Funktionen $f(x,y,z)$ antar lokala max/min endast i punkter där $f_{\hat v}'(a,b,c)=0$ för alla riktningar. Detta motsvarar att

$$\nabla f(a,b,c)=(0,0,0)$$

> **Övning:** Bestäm alla stationära punkter till $f(x,y,z)=x^2+y^2+2z-xy-xz$.<br>
> Vi vet att inre stationära punkter uppfyller $\nabla f=(0,0,0)$, dvs.<br>
> $(2x-y-z,2y-x,2-x)=(0,0,0)$<br>
> Vi ser att $x=2$, och då måste $y=1,z=3$.<br>
> **Svar:** Den enda stationära punkten är $(2,1,3)$.

#### Stationära punkter på en (rand)yta
Om $f(x,y,z)$ är differentierbar gäller, för en icke-singulär lokal extrempunkt på ytan, att<br>
$f_{\hat v}(a,b,c)=0$ för alla $\hat v$ parallella med ytan i punkten.

##### Lagrangevillkoret
I en stationär randpunkt till $f(x,y,z)$ på ytan $g(x,y,z)=0$ gäller att

$$\nabla f(a,b,c)\parallel\nabla g(a,b,c)$$

> **Förklaring:**<br>
> I en stationär randpunkt gäller $f_{\hat v}'=\nabla f\cdot\hat v=0$ för alla $\hat v$ parallella med ytan. Detta ger att $\nabla f\perp\hat v$.<br>
> En normal till ytan $g=0$ ges av $\nabla g$, vilket innebär att $\nabla g\perp\hat v$ (ty $\hat v$ parallell med ytan).
> 
> $$\nabla f\perp\hat v\ \land\nabla g\perp\hat v\text{ för alla }\hat v\text{ i planet}\implies\nabla f\parallel\nabla g$$

> **Exempel:** Bestäm det största värdet som $f(x,y,z)=x+z^2$ antar på enhetssfären.<br>
> Enhetssfären: $x^2+y^2+z^2=1$<br>
> Låt $g(x,y,z)=x^2+y^2+z^2-1=0$<br>
> $f$ är elementär $\implies$ kontinuerlig<br>
> Enhetssfären är en kompakt mängd$\implies f$ antar ett största värde<br>
> Ett största värde kan bara antas i punkter som uppfyller $\nabla f\parallel\nabla g$.
> 
> $$\nabla f\parallel\nabla g\iff\begin{vmatrix}\text{---}\nabla f\text{---}\\\text{---}\nabla g\text{---}\\\begin{matrix}a&b&c\end{matrix}\end{vmatrix}=0,\text{ för alla }a,b,c\in\mathbb R$$
> 
> Vi får $0=\begin{vmatrix}1&0&2z\\2x&2y&2z\\a&b&c\end{vmatrix}=a(-4yz)-b(2z-4xz)+c(2y)$<br>
> $\implies\begin{cases}yz=0\\z(1-2x)=0\\y=0\\x^2+y^2+z^2=1\end{cases}$<br>
> $\implies\begin{cases}z(1-2x)=0\\y=0\\x^2+z^2=1\end{cases}$<br>
> $\implies(\pm1,0,0),(\frac12,0,\pm\frac{\sqrt3}2)$<br>
> Vi har alltså ovanstående 4 punkter där max/min kan antas.<br>
> $f(1,0,0)=1,f(-1,0,0)=-1,f(\frac12,0,\pm\frac{\sqrt3}2)=\frac54$<br>
> **Svar:** Största värde är $\frac54$.

##### Lagrangefunktionen
Stationära punkter till $f(x,y,z)$ på ytan $g(x,y,z)=0$ uppfyller att $\nabla f\parallel\nabla g$.<br>
Detta är ekvivalent (förutsatt $\nabla g\neq\bar0$) med att de är lösningar till ekvationssystemet

$$\begin{cases}\nabla f=\lambda\nabla g\\g(x,y,z)=0\end{cases}$$

Genom att införa Lagrangefunktionen $L(x,y,z,\lambda)=f(x,y,z)-\lambda g(x,y,z)$ ges lösningarna som de stationära punkterna till denna funktion, dvs. $\nabla L=(0,0,0,0)$
> **Övning:** Skriv upp lagrangefunktionen till följande problem:<br>
> a) Bestäm stationära punkter till $f(x,y,z)=xy+yz$ på sfären $x^2+y^2+z^2=2$.
> 
> $L(x,y,z,\lambda)=xy+yz-\lambda(x^2+y^2+z^2-2)$
> 
> b) Bestäm det största värde som summan av tre positiva tal kan anta om deras produkt är 8.
> 
> $L(x,y,z,\lambda)=x+y+z-\lambda(xyz-8)$<br>
> *Observera att vi behöver kontrollera att svaren blir positiva tal (såsom uppgiften kräver)*.

##### Parametrisering av ytan
Om ytan kan parametriseras: $(x,y,z)=(x(s,t),y(s,t),z(s,t))$ uppfyller de stationära punkterna på ytan:

$$\frac\partial{\partial s}f(x(s,t),y(s,t),z(s,t))=0\\\frac\partial{\partial t}f(x(s,t),y(s,t),z(s,t))=0$$

> **Exempel:** Sök stationära punkter för $f(x,y,z)=x+y-z$ på ytan $z=x^2+y^2$.<br>
> Ytan kan parametriseras som $(x,y,z)=(s,t,s^2+t^2)$.<br>
> Vi får $f=s+t-s^2-t^2$, och partialderivatorna måste uppfylla<br>
> $\begin{cases}f_s'=1-2s=0\\f_y'=1-2t=0\end{cases}\iff(s,t)=(\frac12,\frac12)$<br>
> Detta ger slutligen $(x,y,z)=(\frac12,\frac12,\frac12)$

### Stationära punkter på en skärningskurva
*(dvs. kurvor där randytor möts)*

Om $f(x,y,z)$ är differentierbar, då gäller för en icke-singulär lokal extrempunkt på en skärningskurva mellan två ytor att $f_{\hat y}'(a,b,c)=0$ för alla $\hat u$ parallella med kurvan.

#### Lagrangevillkoret
I en stationär punkt till $f(x,y,z)$ på skärningskurvan mellan ytorna $g(x,y,z)=0$ och $h(x,y,z)=0$ gäller att

$$\{\nabla f(a,b,c),\nabla g(a,b,c),\nabla h(a,b,c)\}\text{ är linjärt beroende}$$

> **Härledning:**<br>
> Anta att $(a,b,c)$ är en stationär punkt till $f$ utmed skärningskurvan av två nivåytor $g=0,h=0$.<br>
> För en vektor $\hat v$ som är parallell med denna kurva i punkten $(a,b,c)$ gäller att:
> 
> $$\hat v\perp\nabla g(a,b,c)\text{ samt }\hat v\perp\nabla h(a,b,c)$$
> 
> Givet att $(a,b,c)$ är en stationär randpunkt gäller även att $f'_{\hat v}(a,b,c)=0$, det vill säga:
> 
> $$\hat v\perp\nabla f(a,b,c)$$
> 
> Tre vektorer i $\mathbb R^3$, som alla är vinkelräta mot samma vektor, kan omöjligt vara linjärt oberoende.<br>
> $\therefore$ I en stationär punkt $(a,b,c)$ måste $\{\nabla f(a,b,c),\nabla g(a,b,c),\nabla h(a,b,c)\}$ vara linjärt beroende.

> **Exempel:** Bestäm det största och minsta värde som $xyz$ antar då $x^2+y^2+z^2=1$ och $x+y=1$.<br>
> Låt $f(x,y,z)=xyz,g(x,y,z)=x^2+y^2+z^2-1,h(x,y,z)=x+y-1$.<br>
> Ytorna kan nu skrivas som $g(x,y,z)=0,h(x,y,z)=0$<br>
> Lagrangevillkoret ger att $\{\nabla f,\nabla g,\nabla h\}$ är linjärt beroende.<br>
> $0=\begin{vmatrix}\text{---}\nabla f\text{---}\\\text{---}\nabla g\text{---}\\\text{---}\nabla h\text{---}\end{vmatrix}=\begin{vmatrix}yz&xz&xy\\2x&2y&2z\\1&1&0\end{vmatrix}=2xz^2-2xy^2-2yz^2+2x^2y=2(x-y)(z^2+xy)$
> 
> Två fall:<br>
> (1) $x=y$ vilket ger $x=y=\frac12,z=\pm\frac1{\sqrt2}$<br>
> (2) $xy=-z^2$ vilket ger $1=x^2+(1-x)^2-x(1-x)=3x(x-1)+1\implies(0,1,0),(1,0,0)$
> 
> Min/max måste antas bland dessa<br>
> $f(\frac12,\frac12,\frac1{\sqrt2})=\frac1{4\sqrt2},f(\frac12,\frac12,-\frac1{\sqrt2})=-\frac1{4\sqrt2},f(1,0,0)=f(0,1,0)=0$<br>
> **Svar:** Största värde $\frac1{4\sqrt2}$, minsta värde $-\frac1{4\sqrt2}$.

#### Lagrangefunktionen
När vi söker stationära punkter till $f$ på skärningskurvan mellan ytorna $g=0,h=0$ har vi villkoret
att $\nabla f,\nabla g,\nabla h$ är linjärt beroende. Detta ger ekvationssystemet:

$$\begin{cases}\nabla f(x,y,z)=\lambda\nabla g(x,y,z)+\mu\nabla h(x,y,z)\\g(x,y,z)=0\\h(x,y,z)=0\end{cases}$$

Vi inför Lagrangefunktionen $L(x,y,z,\lambda,\mu)=f(x,y,z)-\lambda g(x,y,z)-\mu h(x,y,z)$. Då ges ekvationssystemets lösningar av de stationära punkterna till $L$:

$$\nabla L=(0,0,0,0,0)$$

> **Exempel:** Bestäm det största och minsta värde som $xyz$ antar då $x^2+y^2+z^2=1$ och $x+y=1$.<br>
> Vi inför $f(x,y,z)=xyz,g(x,y,z)=x^2+y^2+z^2-1,h(x,y,z)=x+y-1$.
> 
> Langrangefunktionen ges av<br>
> $L(x,y,z,\lambda,\mu)=xyz-\lambda(x^2+y^2+z^2-1)-\mu(x+y-1)$<br>
> Stationära punkter till $L$ ges av<br>
> $\begin{cases}L_x'=yz-2\lambda x-\mu=0&(1)\\L_y'=xz-2\lambda y-\mu=0&(2)\\L_z'=xy-2\lambda z=0&(3)\\L_\lambda'=-(x^2+y^2+z^2-1)=0&(4)\\L_\mu=-(x+y-1)=0&(5)\end{cases}$
> 
> $\implies\begin{cases}
> (1-x)z-2\lambda x-\mu=0&(1)
> \\-2\lambda+z-2\mu=0&(2)
> \\x(1-x)-2\lambda z=0&(3)
> \\2x(x-1)+z^2=0&(4)
> \\y=1-x&(5)\end{cases}$<br>
> ...<br>
> Lösningarna till detta blir $(\frac12,\frac12,-\frac1{\sqrt2}),(\frac12,\frac12,\frac1{\sqrt2}),(0,1,0),(1,0,0)$

### Sammanfattande exempel
> **Exempel:** Bestäm det största och minsta värde som $f(x,y,z)=x+y+z$ antar i området $x^2+y^2+z^2\leq1,z\geq0$.<br>
> Max/min kan antas i (1) inre stationära punkter, (2) stationära rand(yt)punkter, och (3) stationära punkter på skärning mellan randytor. Singulära randpunkter och hörnpunkter saknas.
> 
> (1) Inre stationära punkter. $\nabla f(x,y,z)=(1,1,1)=0$ saknar lösning.<br>
> 
> (2) Vi börjar med halvsfären: $x^2+y^2+z^2=1,z\gt0$<br>
> Vi väljer $g(x,y,z)=x^2+y^2+z^2-1=0\implies\nabla g(x,y,z)=(2x,2y,2z)$<br>
> Lagrangevillkoret ger $\begin{vmatrix}a&b&c\\1&1&1\\2x&2y&2z\end{vmatrix}=0\iff x=y=z$<br>
> Eftersom $g=0$ har vi $3x^2=3y^2=3z^2=1\implies(x,y,z)=\begin{matrix}{}_+\\{}^{(-)}\end{matrix}(\frac1{\sqrt3},\frac1{\sqrt3},\frac1{\sqrt3})$
> 
> (3) Nu "bottenplattan": $h(x,y,z)=z=0\implies\nabla h(x,y,z)=(0,0,1)$<br>
> Lagrangevillkoret ger att $\nabla h=(0,0,1)\parallel(1,1,1)=\nabla f$ Omöjligt.
> 
> (4) Sist undersöker vi skärningen mellan de två randytorna $g=0,h=0$.<br>
> Vi har att $\{\nabla f,\nabla g,\nabla h\}$ ska vara linjärt beroende:<br>
> $\begin{vmatrix}1&1&1\\2x&2y&2z\\0&0&1\end{vmatrix}=2y-2x=0\implies x=y$<br>
> Med villkoren $x^2+y^2+z^2=1,z=0$ fås $2x^2=1\implies(x,y,z)=\pm(\frac1{\sqrt2},\frac1{\sqrt2},0)$
> 
> Sammanfattningsvis har vi tre möljliga punkter: $(\frac1{\sqrt3},\frac1{\sqrt3},\frac1{\sqrt3}),(\frac1{\sqrt2},\frac1{\sqrt2},0),(-\frac1{\sqrt2},-\frac1{\sqrt2},0)$<br>
> $f(\frac1{\sqrt3},\frac1{\sqrt3},\frac1{\sqrt3})=\sqrt3$<br>
> $f(\frac1{\sqrt2},\frac1{\sqrt2},0)=\sqrt2$<br>
> $f(-\frac1{\sqrt2},-\frac1{\sqrt2},0)=-\sqrt2$<br>
> **Svar:** Största värde är $\sqrt3$ och minsta värde är $-\sqrt2$.

## Föreläsning 16
### Dubbelintegraler
En dubbelintegral definieras som ett gränsvärde av Riemannsummor:

$${\int\int}_Df(x,y)dxdy=\lim_{\substack{(m,n)\to(\infty,\infty)\\(\Delta x_i,\Delta y_i)\to(0,0)}}\sum_{\substack{0\leq i\leq m-1\\0\leq j\leq n-1}}f(\xi_{ij},\eta_{ij})\Delta x_i\Delta y_i$$

> Om $f(x,y)$ är en kontinuerlig funktion på ett kompakt område $D$ med kontinuerligt deriverbara randkurvor, så existerar dubbelintegralen ${\int\int}_Df(x,y)dxdy$.

#### Icke-rektangulära områden
Om integrationsområdet $D$ inte är en rektangel definierar vi

$${\int\int}_Df(x,y)dxdy={\int\int}_RF(x,y)dxdy$$

där $R$ är en rektangel som innehåller $D$, och $F(x,y)=\begin{cases}f(x,y)&(x,y)\in D\\0&\text{annars}\end{cases}$.

### Olika områden
#### Rektanglar
För en kontinuerlig funktion $f$ på rektangeln $D:a\leq x\leq b,c\leq y\leq d$ integrerar vi en variabel i taget:

$${\int\int}_Df(x,y)dxdy=\int_c^d\int_a^bf(x,y)dxdy$$

#### Enkla områden i y-led
> Ett område är *enkelt i y-led* om det, för varje x-värde, definieras av ett sammanhängande y-intervall.

> **Exempel:** Beräkna ${\int\int}_Dxy^2dxdy$ där<br>
> a) $D:(x,y)|0\leq y\leq 1-x,0\leq x\leq 1$<br>
> ${\int\int}_Dxy^2dxdy=\int_0^1\int_0^{1-x}xy^2dydx=\frac13\int_0^1x(1-x)^3dx=\frac1{60}$
> 
> b) $D:(x,y)|0\leq x\leq1,\frac x2\leq y\leq1-\frac x2$<br>
> ${\int\int}_Dxy^2dxdy=\int_0^1x\int_{x/2}^{1-x/2}y^2dydx=\int_0^1x[\frac{y^3}3]_{x/2}^{1-x/2}dx=\frac{11}{240}$

#### Enkla områden i x-led
> Ett område är *enkelt i x-led* om det, för varje y-värde, definieras av ett sammanhängande x-intervall.

> **Exempel:** Skriv ${\int\int}_Dxy^2dxdy$ som upprepade enkelintegraler över områdena<br>
> a) $-2\leq y\leq2,y+2\leq x\leq4$
> $\implies{\int\int}_Dxy^2dxdy=\int_{-2}^2\int_{y+2}^4xy^2dxdy$

#### Byte av integrationsordning
> **Exempel:** Beräkna $\int_0^4\int_{\sqrt y}^2y\cos(x^5)dxdy$<br>
> Området är $0\leq y\leq4,\sqrt y\leq x\leq2$, vilket är ekvivalent med $0\leq x\leq2,0\leq y\leq x^2$.<br>
> Detta ger $\int_0^4\int_{\sqrt y}^2y\cos(x^5)dxdy=\int_0^2\int_0^{x^2}y\cos(x^5)dydx=\frac12\int_0^2x^4\cos(x^5)dx=\{t=x^5\}\\=\frac1{10}\int_0^{32}\cos(t)dt=\frac1{10}\sin(32)$

## Föreläsning 17
### Areaformler
Ett **polärt areaelement** med vinkel $\Delta\theta$ och radier $r,r+\Delta r$ har arean:

$$A=\frac12 \Delta\theta\cdot((r+\Delta r)^2-r^2)=r\Delta r\Delta\theta+\frac12(\Delta r)^2\Delta\theta$$

För små areaelement (dvs. små $\Delta\theta,\Delta r$) kommer $r\Delta r\Delta\theta\gg\frac12(\Delta r)^2\Delta\theta$ p.g.a. lägre grad i $x,y$ (2 vs. 3).

Ett **parallellogram** som spänns upp av $\bar u,\bar v$ har arean:

$$A=\pm\begin{vmatrix}&\vert&\vert&\\&\bar u&\bar v&\\&\vert&\vert&\end{vmatrix}$$

### Polär substitution
Vid byte till polära koordinater ändras en dubbelintegral enligt formeln.

$${\int\int}_Df(x,y)dydx={\int\int}_Df(r\cos\theta,r\sin\theta)rdrd\theta$$

Detta kan motiveras med följande Riemannsumma:

$$A=\sum_{\substack{0\leq i\lt n\\0\leq j\lt m\\(m,n)\to(\infty,\infty)}}f(r_i\cos\theta_j,r_i\sin\theta_j)r_i\Delta r_i\Delta\theta_j$$

> **Exempel:** Beräkna ${\int\int}_D\frac{(x+y)^2}{1+x^2+y^2}dxdy$ där $D:x^2+y^2\leq1$.<br>
> Integrationsområdet är en cirkelskiva, och $x^2+y^2$ kan lätt förenklas.<br>
> Vi går därför över till polära koordinater:<br>
> $\int_0^1\int_0^{2\pi}\frac{r^2+2r^2\cos\theta\sin\theta}{1+r^2}r\cdot d\theta dr=\int_0^{2\pi}(1+\sin(2\theta))d\theta\cdot\int_0^1\frac{r^3}{1+r^2}dr\\=\int_0^{2\pi}(1+\sin(2\theta))d\theta\cdot\int_0^1\frac{r^2}{1+r^2}rdr=[\theta-\frac12\cos(2\theta)]_0^{2\pi}\cdot\int_1^2\frac{t-1}t\frac12dt=2\pi\cdot\frac12[t-\ln|t|]_1^2\\=\pi(1-\ln2)$<br>
> **Svar:** $\pi(1-\ln2)$

### Allmän substitution
Vid byte till allmänna koordinater $u,v$ ändras en dubbelintegral enligt formeln

$${\int\int}_D=f(x,y)dxdy={\int\int}_Df(x(u,v),y(u,v))\left|\det\frac{\partial(x,y)}{\partial(u,v)}\right|dudv$$

> **Härledning:**
> Ta ett område som är besvärligt att beskriva i $x,y$, men som kan beskrivas som $3\leq u\leq6,2\leq v\leq6$.<br>
> Sambandet mellan koordinatsystemen är: $(x,y)=(x(u,v),y(u,v))$<br>
> 
> Vi delar upp området i ett $u,v$-rutnät.<br>
> Varje sådan ruta, med kantvektorer $\begin{bmatrix}\Delta u_i\\0\end{bmatrix}$ och $\begin{bmatrix}0\\\Delta v_j\end{bmatrix}$ i $u,v$-koordinater, kan approximativt översättas till $J_{ij}\begin{bmatrix}\Delta u_i\\0\end{bmatrix}$ respektive $J_{ij}\begin{bmatrix}0\\\Delta v_j\end{bmatrix}$.<br>
> Volymen under grafen blir i detta område
> 
> $$f(x(u_i,v_j)),y(u_i,v_j))\left|\det\left({J_{ij}\begin{bmatrix}\Delta u_i&0\\0&\Delta v_j\end{bmatrix}}\right)\right|\\=f(x(u_i,v_j)),y(u_i,v_j))|\det{J_{ij}}|\Delta u_i\Delta v_j$$
> 
> För hela området beskrivs volymen av en Riemannsumma:
> 
> $$V=\lim_{n\to\infty}\sum f(x(u_i,v_j),y(u_i,v_j))|\det{J_{ij}}|\Delta u_i\Delta v_j$$
> 
> Detta kan beskrivas som en dubbelintegral enligt definitionen ovan.

> **Exempel:** Beräkna ${\int\int}_De^{x-y}dxdy$ där $D$ är parallellogrammet med hörn $(0,0),(1,1),(2,1),(1,0)$.<br>
> *Denna uppgift går även att lösa genom att se området som enkelt i x-led (dvs. ett sammanhängande $x$-intervall ges för varje $y$).*
> 
> Med variabelsubstitution:<br>
> Inför en ny bas $B=\{\bar u,\bar v\}=\{(1,0),(1,1)\}$. I denna bas blir området rektangulärt: $\begin{cases}0\leq u\leq 1\\0\leq v\leq1\end{cases}$<br>
> Sambandet ges av $x=u+v,y=v$.<br>
> Vi har nu
> 
> $${\int\int}_De^{x-y}dxdy={\int\int}_De^{u+v+v}\left|\det\frac{\partial(x,y)}{\partial(u,v)}\right|dudv={\int\int}_De^{u+v+v}\begin{vmatrix}1&1\\0&1\end{vmatrix}dudv={\int\int}_De^{u+v+v}dudv\\=\int_0^1\int_0^1e^{u+2v}dudv$$

> **Härledning av polär substitution** Härled formeln för polär substitution
> 
> $${\int\int}_Df(x,y)dxdy={\int\int}_Df(r\cos\theta,r\sin\theta)rdrd\theta$$
> 
> ur formeln för allmän substitution.
> 
> Vi har $x=r\cos\theta,y=r\sin\theta$.
> 
> $${\int\int}_Df(x,y)dxdy={\int\int}_Df(r\cos\theta,r\sin\theta)\left|\det\begin{bmatrix}\cos\theta&-r\sin\theta\\\sin\theta&r\cos\theta\end{bmatrix}\right|drd\theta\\={\int\int}_Df(r\cos\theta,r\sin\theta)rdrd\theta$$

### Icke-linjärt variabelbyte
> **Exempel:** Bestäm arean av området $1\leq x+y\leq2,\ 1\leq\frac yx\leq2$.<br>
> Låt $f(x,y)=1$ och integrera över området.<br>
> $A={\int\int}_Ddxdy$<br>
> Nästa steg är att införa nya koordinater $\begin{cases}u=x+y\\v=\frac yx\end{cases}\iff D:\begin{cases}1\leq u\leq2\\1\leq v\leq2\end{cases}$.<br>
> Detta ger:
> 
> $$A={\int\int}_Ddxdy=\int_1^2\int_1^2\left|\det\frac{\partial(x,y)}{\partial(u,v)}\right|dudv\\=\int_1^2\int_1^2\left|\det\left(\frac1{1+v}\begin{bmatrix}1&-\frac u{1+v}\\v&\frac u{1+v}\end{bmatrix}\right)\right|dudv\\=\int_1^2\int_1^2\left|\left(\frac1{1+v}\right)^2\det\begin{bmatrix}1&-\frac u{1+v}\\v&\frac u{1+v}\end{bmatrix}\right|dudv\\=\int_1^2\int_1^2\left|\left(\frac1{1+v}\right)^3\det\begin{bmatrix}1&-u\\v&u\end{bmatrix}\right|dudv\\=\int_1^2\int_1^2\frac{|u|}{(1+v)^2}dudv=\int_1^2\frac1{(1+v)^2}dv\int_1^2udu\\=\left[-\frac1{1+v}\right]_1^2\cdot\left[\frac{u^2}2\right]_1^2=\frac16\cdot\frac32=\frac14$$
> 
> **Svar:** Arean är 1/4 a.e.

### Udda funktioner
En funktion $f(x,y)$ är udda...

* i $x$-led om $f(-x,y)=-f(x,y)$,
* i $y$-led om $f(x,-y)=-f(x,y)$

Om en udda funktion i $x$- eller $y$-led integreras över ett område som är symmetriskt i samma riktning är

$${\int\int}_Df(x,y)dxdy=0$$

### Generaliserade dubbelintegraler
En dubbelintegral är *generaliserad* om antingen

1. integrationsområdet är obegränsat, och/eller
2. integranden är obegränsad.

#### Uttömmande följd
Ett öppet område $D$ töms ut av en följd $D_1\sub D_2\sub\cdots$ av områden inuti $D$ om

1. varje $D_n$ är begränsad och mätbar (dvs. har en väldefinierad area), samt
2. för varje kompakt mängd $G\sub D$ finns ett område $D_n$ som innehåller $G$.

### Definition av generaliserade dubbelintegraler
En generaliserad dubbelintegral definieras som

$${\int\int}_Df(x,y)dxdy=\lim_{n\to\infty}{\int\int}_{D_n}f(x,y)dxdy$$

om gränsvärdet existerar och är lika för alla uttömmande följder $\{D_n\}$ där $f(x,y)$ är begränsad.

För funktioner $f\geq0$ räcker det att visa att

$$\lim_{n\to\infty}{\int\int}_{D_n}f(x,y)dxdy$$

existerar för någon uttömmande följd $\{D_n\}$ för att kunna dra slutsatsen att dubbelintegralen är konvergent (dvs. existerar).

> **Exempel:** Undersök om ${\int\int}_{\mathbb R^2}\frac1{(1+x^2+y^2)^2}dxdy$ är konvergent och beräkna i så fall integralens värde.<br>
> Vi väljer en uttömmande följd av $\mathbb R^2$ som cirkelskivor $D_n:x^2+x^2\leq n^2$.<br>
> Vi har ${\int\int}_{D_n}\frac1{(1+x^2+y^2)^2}dxdy=\{\text{till polära koordinater}\}=\int_0^{2\pi}\int_0^n\frac1{(1+r^2)^2}rdrd\theta\\=\int_0^{2\pi}d\theta\int_0^n\frac1{(1+r^2)^2}rdr=\{t=1+r^2\}=2\pi\int_1^{1+n^2}\frac1{2t^2}dt=\pi[-\frac1t]_1^{1+n^2}=\pi(1-\frac1{1+n^2})$<br>
> Vi undersöker gränsvärdet:<br>
> $\lim_{n\to\infty}{\int\int}_{D_n}\frac1{(1+x^2+y^2)^2}dxdy=\lim_{n\to\infty}\pi(1-\frac1{1+n^2})=\pi$<br>
> **Svar:** Eftersom integranden är positiv visar detta att dubbelintegralen är konvergent och lika med $\pi$.

#### Absolutkonvergenta generaliserade dubbelintegraler
En generaliserad dubbelintegral är konvergent omm den är *absolutkonvergent*:

$${\int\int}_Df(x,y)dxdy\text{ konvergent}\iff{\int\int}_D|f(x,y)|dxdy\text{ konvergent}$$

### Fubinis sats
Om $f(x,y)\geq0$ och någon av integralerna

* $\int\int f(x,y)dxdy$ över $D$ *(den generaliserade dubbelintegralen)*
* $\int(\int f(x,y)dx)dy$ över $D$
* ${\int(\int}f(x,y)dy)dx$ över $D$

är konvergent, då är alla tre konvergenta och har samma värde.

> **Exempel:** Undersök om ${\int\int}_{\substack{x\geq0\\y\geq0}}\frac1{(1+x^2)(1+y^2)}dxdy$ är konvergent.<br>
> Dubbelintegralen är generaliserad (då området är obegränsat) och integranden är positiv.<br>
> $\int_0^\infty\left(\int_0^\infty\frac1{(1+x^2)(1+y^2)}dx\right)dy=\int_0^\infty\frac1{1+y^2}dy\int_0^\infty\frac1{1+x^2}dx=[\arctan y]_0^\infty[\arctan x]_0^\infty=\frac{\pi^2}4$

> **Exempel:** Beräkna ${\int\int}_{0\leq x\leq1}\frac1{1+(x-2y)^2}dxdy$.<br>
> Integrationsområdet är obegränsat$\implies$generaliserad dubbelintegral<br>
> Integranden är positiv$\implies$Fubinis sats kan användas<br>
> ${\int\int}_{0\leq x\leq1}\frac1{1+(x-2y)^2}dxdy=\int_0^1(\int_{-\infty}^\infty\frac1{1+(x-2y)^2}dy)dx=\{t=x-2y\}=-\frac12\int_0^1(\int_\infty^{-\infty}\frac1{1+t^2}dt)dx\\=\frac12\int_0^1[\arctan t]_{-\infty}^\infty dx=\frac12\int_0^1\frac\pi2+\frac\pi2dx=\frac\pi2$<br>
> **Svar:** Enligt Fubinis sats är den generaliserade dubbelintegralen konvergent med värde $\frac\pi2$.

## Föreläsning 18
### Kryssprodukt i planet
Ett parallellogram som spänns upp av $\vec u=(u_1,u_2),\vec v=(v_1,v_2)$ har arean

$$A=|\vec u\times\vec v|=\left|\det\begin{bmatrix}u_1&u_2\\v_1&v_2\end{bmatrix}\right|$$

### Cirkulation
Om en kurva $\gamma$ är *enkel* (inte skär sig själv) och *sluten* kurva med *positiv (moturs) orientering* så definieras cirkulationen av ett vektorfält $\vec F$ runt $\gamma$ som:

$$\oint_\gamma\vec F\cdot d\vec r$$

Cirkulationen mäter hur mycket $\vec F$ flödar utmed kurvan.

> **Exempel 1:** Visa att om $\vec F=(a+bx+cy,e+fx+gy)$ och $\gamma$ är den positivt orienterade randkurvan till en triangel $D:(x_1,y_1),(x_2,y_2),(x_3,y_3)$ så är
> 
> $$\boxed{\oint_\gamma\vec F\cdot d\vec r=(f-c)\cdot \text{area}(D)}$$
> 
> $$HL=(f-c)\cdot\text{area}(D)=\frac12(f-c)\begin{vmatrix}x_2-x_1&y_2-y_1\\x_3-x_1&y_3-y_1\end{vmatrix}\\=\frac12(f-c)\left((x_2-x_1)(y_3-y_1)-(x_3-x_1)(y_2-y_1)\right)$$
> 
> $\vec F=(a+bx,e+gy)+(cy,fx)$ där den vänstra termen är ett konservativt vektorfält!<br>
> Dvs. $\oint_\gamma\vec F\cdot d\vec r=\oint_\gamma(cy,fx)\cdot d\vec r=\{\text{dela upp kurvan i en del/sida i triangeln}\}=I_1+I_2+I_3$<br>
> $I_1=\left\{\begin{matrix}\vec r=\begin{bmatrix}x_1\\y_1\end{bmatrix}+t\begin{bmatrix}x_2-x_1\\y_2-y_1\end{bmatrix}\\\text{där }t:0\to1\\d\vec r=\frac{d\vec r}{dt}dt=\begin{bmatrix}x_2-x_1\\y_2-y_1\end{bmatrix}dt\end{matrix}\right\}=\int_0^1(y_1+t(y_2-y_1))(x_2-x_1)c+(x_1+t(x_2-x_1))(y_2-y_1)fdt\\I_2=\dots\\I_3=\dots$<br>
> **Svar:** Med *Maple* fås att likheten gäller.

> **Övning:** (kopplat till exemplet ovan)<br>
> Bestäm cirkulationen av<br>
> a) $\vec F=(3x+4y,6y)$ runt den positivt orienterade triangeln $\gamma$ med hörn $(0,0),(5,0),(0,5)$<br>
> Enligt exemplet ovan gäller att
> 
> $$\oint_\gamma(3x+4y,6y)\cdot d\vec r=(-4)\cdot\text{area}(D_1)=-50$$
> 
> **Svar:** -50
> 
> b) $\vec F=(1-x+2y,3+2x-y)$ runt den negativt orienterade triangeln $\gamma$ med hörn $(0,0),(6,6),(6,3)$.
> Enligt exemplet ovan gäller att
> 
> $$\oint_\gamma(1-x+2y,3+2x-y)\cdot d\vec r=(2-2)\cdot\text{area}(D_2)=0$$
> 
> **Svar:** 0

#### Alternativ definition av cirkulation
$$\oint_\gamma\vec n\times\vec Fds$$

där $ds$ är båglängdselementet och $\vec n$ är den *utåtpekande enhetsnormalen*.
> **Härledning:**<br>
> Vi har en kurva $\gamma$ som vi parametriserar $\vec r(t)=(x(t),y(t)),t:a\to b$.<br>
> Vi börjar med att visa att $\vec nds=(\dot y(t),-\dot x(t))dt$:<br>
> **Belopp:** Båda led har samma längd.<br>
> $||\text{VL}||=ds=\sqrt{\dot x^2+\dot y^2}dt$<br>
> $||\text{HL}||=\sqrt{\dot y^2+(-\dot x)^2}dt\implies=||\text{VL}||$<br>
> **Riktning:** Båda led har samma riktning.<br>
> $\text{VL}$ har riktningen $\vec n\perp(\dot x,\dot y)$<br>
> $\text{HL}$ har riktningen $(\dot y,-\dot x)\perp(\dot x,\dot y)$<br>
> $\therefore\text{VL}=\text{HL}$<br>
> Vi får då att
> $\oint_\gamma\vec n\times\vec Fds=\oint_\gamma(\dot y,-\dot x)\times\vec Fdt\\=\oint_\gamma\begin{vmatrix}\dot y&-\dot x\\P&Q\end{vmatrix}dt=\oint_\gamma(\dot yQ+\dot xP)dt=\oint_\gamma(P\dot x+Q\dot y)dt=\oint_\gamma\vec F\cdot d\vec r$<br>
> **Slutsats:** Den alternativa definitionen gäller.

### Flöde i planet
Om $\gamma$ är randkurvan till ett öppet område så definieras flödet av ett vektorfält $\vec F$ *ut ur området* som

$$\oint_\gamma\vec n\cdot\vec Fds$$

där $\vec n$ är den utåtpekande enhetsnormalen.
> **Exempel 2:** Visa att om $\vec F=(a+bx+cy,e+fx+gy)$ och $\gamma$ är den positivt orienterade randkurvan till en triangel $D$ så är

$$\boxed{\oint_\gamma\vec n\cdot\vec Fds=(b+g)\cdot\text{area}(D)}$$

> Anta att vi har parametriserat $\gamma:\vec r(t)=(x(t),y(t)),t:a\to b$<br>
> $\vec nds=(\dot y(t),-\dot x(t))dt$<br>
> $\vec F=(P,Q)$<br>
> $\oint_\gamma\vec n\cdot\vec Fds=\int_a^b(\dot y(t),-\dot x(t))\cdot(P,Q)dt=\int_a^b(-Q,P)\cdot(\dot x,\dot y)dt=\oint_\gamma(-Q,P)\cdot d\vec r\\=\{\text{från exempel 1}\}=(b-(-g))\cdot\text{area}(D)$<br>
> **VSV**

> **Övning:** Beräkna flödet.
> a) $\vec F=(x+2y,1-x+y)$
> Flödet är $\oint_\gamma\vec n\cdot\vec Fds=(1+1)\cdot\text{area(triangeln)}$
> 
> b) $\vec F=(1-3x,x+3y)$
> Flödet är $\oint_\gamma\vec n\cdot\vec Fds=(-3+3)\cdot\text{area(triangeln)}=0$

### Rotation (*cirkulationsdensitet*) av vektorfält
Rotationen av ett vektorfält $\vec F=(P,Q)$ betecknas

$$\text{rot}\ \vec F=\nabla\times\vec F=\begin{vmatrix}\frac\partial{\partial x}&\frac\partial{\partial y}\\P&Q\end{vmatrix}=\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y}$$

och anger hur mycket vektorfältet virvlar i en punkt.

Om vi ser vektorfältet som ett hastighetsfält till en vätska, kan ovanstående definition liknas vid att placera att ett skovelhjul i en punkt, och studera hur det roterar.

> **Övning:** En vätskas hastighetsfält ges av $\vec v=(x^2,xy)$. Hur snurrar ett skovelhjul placerat längs a) positiva x-axeln, b) negativa x-axeln, c) positiva y-axeln, och d) negativa y-axeln?
> 
> Vi beräknar rotationen:<br>
> $\text{rot}\ \vec v=\nabla\times\vec v=\frac\partial{\partial x}(xy)-\frac\partial{\partial y}(x^2)=y$
> 
> a+b) $\text{rot}\ \vec v=0\implies$Ingen rotation.<br>
> c) $\text{rot}\ \vec v\gt0\implies$Positiv (moturs) rotation.<br>
> d) $\text{rot}\ \vec v\lt0\implies$Negativ (medurs) rotation.

#### Rotation som cirkulationsdensitet
Rotationen kan ses som en cirkulationsdensitet och ges då av

$$\text{rot}\ \vec F(a,b)=\lim_{\text{area}(D)\to0}\frac1{\text{area}(D)}\oint_{\partial D}\vec F\cdot d\vec r$$

där $D$ är en triangel som innehåller $(a,b)$ och $\partial D$ är dess positivt orienterade randkurva.

> **Härledning:**
> $\vec F=(P,Q)$<br>
> Vi gör en linjär approximation av vektorfältet kring $(a,b)$<br>
> $\vec F(a+h,b+k)=\vec F(a,b)+\begin{pmatrix}\frac{\partial P}{\partial x}&\frac{\partial P}{\partial y}\\\frac{\partial Q}{\partial x}&\frac{\partial Q}{\partial y}\end{pmatrix}\begin{pmatrix}h\\k\end{pmatrix}+\text{felterm}$
> 
> När vi närmar oss $(a,b)$ kommer feltermen $\to0$ snabbare än övriga termer.<br>
> Dvs.
> 
> $$\oint_{\partial D}\vec F\cdot d\vec r=\{\text{area}(D)\to0\}=\oint_{\partial D}\text{(linjärt vektorfält)}\cdot d\vec r=\{\text{exempel 1}\}\\=\left(Q'_x(a,b)-P'_y(a,b)\right)\cdot\text{area}(D)$$
> 
> $$\frac1{\text{area}(D)}\oint_{\partial D}\vec F\cdot d\vec r=Q'_x-P'_y=\text{rot}\ \vec F(a,b)$$
> 
> **VSV**

### Greens formel
Låt $D$ vara ett slutet område med en styckvis kontinuerligt deriverbar rand $\partial D$ som är positivt orienterad, och antag att $\vec F=(P,Q)$ är kontinuerligt deriverbart på $D$. Då är vektorfältets cirkulation kring randen:

$$\oint_{\partial D}\vec F\cdot d\vec r={\int\int}_D\text{rot}\ \vec Fdxdy$$

> **Tolkning:**
> 
> $$\text{cirkulationen av }\vec F\text{ runt }D={\int\int}_D\text{(cirkulationsdensitet)}dxdy$$
> 
> Jämför:
> 
> $$\text{massa av }D={\int\int}_D\text{(massdensitet)}dxdy\\\text{laddning av }D={\int\int}_D\text{(laddningstäthet)}dxdy$$

> **Motivering:**<br>
> Vi kan dela upp området $D$ i små trianglar $T_i$ och beräkna cirkulationen kring var och en av dessa. Vi beräknar summan av dessa cirkulationer, och noterar att sidor som delas av två trianglar kommer att genomlöpas två gånger, men i motsatta riktningar. Dessa tar alltså ut varandra, och vi får alltså
> 
> $$\oint_{\partial D}\vec F\cdot d\vec r\approx\sum\oint_{\partial T_i}\vec F\cdot d\vec r$$
> 
> Om $T_i$ är liten gäller att $\oint_{\partial T_i}\vec F\cdot d\vec r\approx\text{rot}\left(\vec F(x_i,y_i)\right)\cdot A_i$, dvs.
> 
> $$\oint_{\partial D}\vec F\cdot d\vec r\approx\sum\text{rot}\left(\vec F(x_i,y_i)\right)\cdot A_i$$
> 
> När vi delar upp området i mindre och mindre trianglar kommer denna riemannsumma att konvergera mot
> 
> $${\int\int}_D\text{rot}\vec F(x,y)dxdy$$
> 
> *Detta är Greens formel.*

> **Exempel:** Beräkna
> 
> $$\int_\gamma(x^4-y^2)dx+(x^4+y^2)dy$$
> 
> längs parabeln $y=x^2$ från $(-1,1)$ till $(1,1)$ och linjen $y=1$ från $(1,1)$ till $(-1,1)$.
> 
> Vi vill alltså beräkna $\int_\gamma(x^4-y^2)dx+(x^4+y^2)dy$.
> 
> *Metod 1: Parametrisering*<br>
> Vi delar upp kurvan i två delar:<br>
> $\gamma_1:(x,y)=(t,t^2),t:-1\to1$ och $\gamma_2:(x,y)=(t,1),t:1\to-1$
> 
> $$\int_{\gamma_1}\vec F\cdot d\vec r=\int_{-1}^1(t^4-t^4,t^4+t^4)\cdot(1,2t)dt=\int_{-1}^14t^5dt=\frac46[t^6]_{-1}^1=0$$
> 
> $$\int_{\gamma_2}\vec F\cdot d\vec r=\int_1^{-1}(t^4-1,t^4+1)\cdot(1,0)dt=\int_1^{-1}t^4-1dt=\frac15[t^5-5t]_1^{-1}=\frac85$$
> 
> **Svar:** $\int_\gamma\vec F\cdot d\vec r=0+\frac85=\frac85$
> 
> *Metod 2: Greens formel.*<br>
> Vi ser att kurvan är sluten. Vi vill alltså beräkna en cirkulation
> 
> $$\int_\gamma\vec F\cdot d\vec r={\int\int}_D\text{rot}\ \vec Fdxdy=\int_{-1}^1\int_{x^2}^1(\nabla\times\vec F)dydx=\int_{-1}^1\int_{x^2}^1(4x^3+2y)dydx\\=\left\{\begin{matrix}\text{i }x\text{-led är området}\\\text{symmetriskt \& }x^3\text{ udda}\end{matrix}\right\}=\int_{-1}^1\int_{x^2}^12ydydx=\int_{-1}^1[y^2]_{x^2}^1dx=\int_{-1}^1(1-x^4)dx=\frac85$$
> 
> **Svar:** $\int_\gamma\vec F\cdot d\vec r=\frac85$

### Vektorpotential i planet
Ett vektorfält $\vec A$ kallas för en *vektorpotential* till $f(x,y)$ om

$$f(x,y)=\text{rot}\ \vec A=\nabla\times\vec A$$

*Observera att vektorpotentialen inte är unik! Även $\vec A+\vec F$, där $\vec F$ är ett konservativt vektorfält, är en vektorpotential eftersom $\text{rot}(\vec A+\vec F)=\text{rot}\ \vec A+\text{rot}\ \vec F=f(x,y)+0=f(x,y)$.*
> **Exempel:** Bestäm en vektorpotential till $f(x,y)=xy$.<br>
> Vi söker $\vec A=(P,Q)$ s.a. $\text{rot}\ \vec A=Q'_x-P'_y=xy$.<br>
> **Svar:** T.ex. $\vec A=(0,\frac12x^2y)$

> **Övning:** Bestäm en vektorpotential till<br>
> a) $f(x,y)=1$<br>
> Vi söker $\vec A=(P,Q)$ s.a. $\text{rot}\ \vec A=Q'_x-P'_y=1$. **Svar:** t.ex. $\vec A=(0,x)$
> 
> b) $f(x,y)=x$<br>
> Vi söker $\vec A=(P,Q)$ s.a. $\text{rot}\ \vec A=Q'_x-P'_y=x$. **Svar:** t.ex. $\vec A=(-xy,0)$
> 
> c) $f(x,y)=y$<br>
> Vi söker $\vec A=(P,Q)$ s.a. $\text{rot}\ \vec A=Q'_x-P'_y=y$. **Svar:** t.ex. $\vec A=(0,xy)$
> 
> d) $f(x,y)=(x+y)e^{x^2+y^2}$<br>
> Vi söker $\vec A=(P,Q)$ s.a. $\text{rot}\ \vec A=\frac\partial{\partial x}Q-\frac\partial{\partial y}P=xe^{x^2+y^2}+ye^{x^2+y^2}$<br>
> **Svar:** T.ex. $\vec A=(-\frac12e^{x^2+y^2},\frac12e^{x^2+y^2})$

### Greens formel baklänges
Greens formel kan skrivas som

$${\int\int}_Df(x,y)dxdy=\oint_{\partial D}\vec A\cdot d\vec r$$

där $\vec A$ är en vektorpotential till $f(x,y)$.

Formeln kan ses som en motsvarighet till integralkalkylens huvudsats

$$\int_a^bf(x)dx=F(b)-F(a)$$

*(i båda fallen reduceras en integral över hela området till användning av en "primitiv funktion" på randen)*

> **Övning:** Härled en kurvintegralformel för<br>
> a) Arean av området $D$: ${\int\int}_Ddxdy$<br>
> Vi söker en vektorpotential till $1$. T.ex. $\vec A=(0,x)$.<br>
> **Svar:** ${\int\int}_Ddxdy=\oint_{\partial D}\vec A\cdot(0,x)d\vec r$
> 
> b) Yttröghetsmomentet med avseende på y-axeln för en balk med tvärsnitt $D$: $I_y=\rho{\int\int}_Dydxdy$<br>
> Vi söker en vektorpotential till $y$. T.ex. $\vec A=(0,xy)$.<br>
> **Svar:** $I_y=\oint_{\partial D}(0,xy)\cdot d\vec r$

> **Exempel:** Beräkna ${\int\int}_D(x^2+y^2)dxdy$ där $D$ är cirkelskivan $x^2+y^2\leq1$.<br>
> *Metod 1:*
> 
> $${\int\int}_D(x^2+y^2)dxdy=\int_0^{2\pi}\int_0^1r^3drd\theta=\int_0^{2\pi}\frac14d\theta=\frac\pi2$$
> 
> *Metod 2: Greens formel baklänges.*<br>
> Vi söker en vektorpotential till $x^2+y^2$. T.ex. $\vec A=(-\frac13y^3,\frac13x^3)$<br>
> Vi parametriserar enhetscirkeln: $(x,y)=(\cos t,\sin t)$
> 
> $${\int\int}_D(x^2+y^2)dxdy=\oint_{\partial D}(-\frac13y^3,\frac13x^3)\cdot d\vec r=\int_0^{2\pi}\left(-\frac13\sin^3t,\frac13\cos^3t\right)\cdot(-\sin t,\cos t)dt\\=\frac13\int_0^{2\pi}\sin^4t+\cos^4tdt=\{\text{lite besvärligt}\}=\frac13\left(\frac{3\pi}4+\frac{3\pi}4\right)=\frac\pi2$$

### Divergens (*flödesdensitet*)
Divergensen av ett vektorfält $\vec F=(P,Q)$ är

$$\text{div}\ \vec F=\nabla\cdot\vec F=P'_x+Q'_y$$

och mäter hur mycket vektorfältet sprids ut i en punkt.

> **Övning:** En vätskas hastighetsfält ges av $\vec v=(x^2,xy)$.<br>
> Ange om en punkter i a) 1:a, b) 2:a, c) 3:e, d) 4:e kvadranten är källor ($\text{div}\gt0$) eller sänkor ($\text{div}\lt0$).
> 
> Vi får $\text{div}\ \vec F=\nabla\cdot\vec F=2x+x=3x$
> 
> a+d) I 1:a och 4:e kvadranterna är $x\gt0\implies\text{div}=3x\gt0$. **Svar:** Källor.
> b+c) I 2:a och 3:e kvadranterna är $x\lt0\implies\text{div}=3x\lt0$. **Svar:** Sänkor.

#### Divergens som flödesdensitet
Divergensen kan ses som en flödesdensitet och ges då av

$$\text{div}\ \vec F(a,b)=\lim_{\text{area}(D)\to0}\frac1{\text{area}(D)}\oint_{\partial D}\vec n\cdot\vec Fds$$

där $D$ är en triangel innehållandes $(a,b)$ och $\partial D$ är dess randkurva.


### Gauss sats i planet
Låt $D$ vara ett slutet område med en styckvis kontinuerligt deriverbar rand $\partial D$ med utåtpekande enhetsnormal $\vec n$, och antag att $\vec F=(P,Q)$ är kontinuerligt deriverbar på $D$. Då är

$$\oint_{\partial D}\vec n\cdot\vec Fds={\int\int}_D\text{div}\ \vec Fdxdy$$

> **Övning:** Beräkna flödesintegralerna med Gauss sats.<br>
> a) $\oint_\gamma\vec n\cdot(xy,x+y)ds={\int\int}_Dy+1dxdy$<br>
> b) $\oint_\gamma\vec n\cdot(x^2,y)ds={\int\int}_D2x+1dxdy$

## Föreläsning 19
### Trippelintegraler
Trippelintegralen över ett rätblock $D$ i rummet definieras som ett gränsvärde av Riemannsummor:

$${\int\int\int}_Df(x,y,z)dxdydz=\lim_{\substack{l,m,n\to\infty\\\Delta x_i,\Delta y_i,\Delta z_k\to0}}\sum_{\substack{0\leq i\lt l\\0\leq j\lt m\\0\leq k\lt n}}f(\xi_{ijk},\eta_{ijk},\tau_{ijk})\Delta x_i\Delta y_j\Delta z_k$$

Om $f(x,y,z)$ är en kontinuerlig funktion på ett kompakt område $D$ med kontinuerligt deriverbara randytor, så existerar trippelintegralen

$$\iiint_Df(x,y,z)dxdydz$$

och motsvarande Riemannsumma konvergerar mot samma värde oavsett partitionering.

#### Rätblock
Om $f$ är en kontinuerlig funktion på ett rätblock $D:a\leq x\leq b,c\leq y\leq d,e\leq z\leq f$ kan motsvarande trippelintegral beräknas som en upprepad enkelintegral:

$$\iiint_Df(x,y,z)dxdydz=\int_a^b\left(\int_c^d\left(\int_e^ff(x,y,z)dz\right)dy\right)dx$$

#### Enkla områden i z-led
Om varje uppsättning av $x,y$ ger ett sammanhängande intervall $a(x,y)\leq z\leq b(x,y)$ kallas området för *enkelt i z-led*. En trippelintegral över ett sådant område $K$ kan beräknas som:

$$\iiint_Kf(x,y,z)dxdydz=\iint_D\left(\int_{a(x,y)}^{b(x,y)}f(x,y,z)dz\right)dxdy$$

Motsvarande gäller för enkla områden i x- eller y-led.

> Alternativ beteckning för den upprepade integralen:
> 
> $$\iint_Ddxdy\int_{a(x,y)}^{b(x,y)}f(x,y,z)dz$$

#### Snittning
Vid snittning skivar vi upp området i snitt längs med en axel. En trippelintegral kan då beräknas som

$$\iiint_Kf(x,y,z)dxdydz=\int_a^b\left(\iint_{D_z}f(x,y,z)dxdy\right)dz$$

där $D_z$ är snittytan för aktuellt $z$.

## Föreläsning 20
### Volymformler
#### Cylindriskt volymelement
$V_\text{c}=r\Delta r\Delta\theta\Delta z+\frac12(\Delta r)^2\Delta\theta\Delta z\approx\{\text{för små }\Delta r,\Delta\theta,\Delta z\}\approx r\Delta r\Delta\theta\Delta z$

#### Sfäriskt volymelement
$V_\text{s}\approx\{\text{för små }\Delta r,\Delta\phi,\Delta\theta\}\approx r^2\sin\phi\Delta r\Delta\phi\Delta\theta$

#### Parallellepiped
Volymen av den parallellepiped som spänns upp av $\vec u,\vec v,\vec w$ ges av

$$V=\left|\det\begin{bmatrix}|&|&|\\\vec u&\vec v&\vec w\\|&|&|\end{bmatrix}\right|$$

### Variabelsubstitution
#### Cylindrisk substitution
$$\iiint_Kf(x,y,z)dxdydz=\iiint_Kf(r\cos\theta,r\sin\theta,z)rdrd\theta dz$$

> **Övning:** Skriv integralerna efter en cylindrisk substitution.<br>
> a) $\iiint_Kx^2zdxdydz$ där $K$ är första oktantens fjärdedel av cylindern $0\leq r\leq2,0\leq z\leq3$
> 
> $$\iiint_Kx^2zdxdydz=\iiint_{\substack{0\leq r\leq2\\0\leq\theta\leq\frac\pi2\\0\leq z\leq3}}r^2\cos^2(\theta)zrdrd\theta dz$$
> 
> b) $\iiint_K3y^2dxdydz$ där $K$ är första oktantens fjärdedel av konen med radie 2 och höjd 3
> 
> $$\iiint_K3y^2dxdydz=\iiint_{\substack{0\leq r\leq2\\0\leq\theta\leq\frac\pi2\\0\leq z\leq3-\frac{3r}2}}3r^2\sin^2(\theta)rdrd\theta dz$$

> **Exempel:** Beräkna $\iiint_K(x^2-y^2)zdxdydz$ där $K:1\leq x^2+y^2\leq4,0\leq z\leq2$.
> 
> $$\iiint_K(x^2-y^2)zdxdydz=\iiint_{\substack{1\leq r\leq2\\0\leq\theta\leq2\pi\\0\leq z\leq2}}(r^2\cos^2(\theta)-r^2\sin^2(\theta))zrdrd\theta dz\\=\int_0^2\left(\int_0^{2\pi}\left(\int_1^2zr^3\cos(2\theta)dr\right)d\theta\right)dz=\int_0^2zdz\cdot\int_0^{2\pi}\cos(2\theta)d\theta\cdot\int_1^2r^3dr\\=2\cdot0\cdot\frac{15}4$$

#### Sfärisk substitution
$$\iiint_Kf(x,y,z)dxdydz=\iiint_Kf(r\sin\phi\cos\theta,r\sin\phi\sin\theta,r\cos\phi)r^2\sin\phi drd\phi d\theta$$

> **Övning:** Skriv integralerna efter en sfärisk substitution.<br>
> a) $\iiint_K(x^2+y^2)zdxdydz$ där $K$ är 1:a oktantens åttondel av klotet med radie 2 och medelpunkt i origo.
> 
> $$\iiint_K(x^2+y^2)zdxdydz=\iiint_{\substack{0\leq r\leq2\\0\leq\phi\leq\frac\pi2\\0\leq\theta\leq\frac\pi2}}r^2\sin^2(\phi)r\cos\phi r^2\sin\phi drd\phi d\theta\\=\iiint_{\substack{0\leq r\leq2\\0\leq\phi\leq\frac\pi2\\0\leq\theta\leq\frac\pi2}}r^5\sin^3(\phi)\cos(\phi)drd\phi d\theta$$
> 
> b) $\iiint_K(x^2+y^2)zdxdydz$ där $K$ är området $0\leq r\leq2,0\leq\phi\leq\frac\pi3,0\leq\theta\leq2\pi$.
> 
> $$\iiint_K\frac{xy}{1+x^2+y^2+z^2}dxdydz=\iiint_K\frac{r^2\sin^2(\phi)\cos(\theta)\sin(\theta)}{1+r^2}r^2\sin(\phi)drd\phi d\theta\\=\iiint_K\frac{r^4\sin^3(\phi)\cos(\theta)\sin(\theta)}{1+r^2}drd\phi d\theta$$

> **Exempel:** Beräkna $\iiint_K(x^2+y^2)dxdydz$ där $K:1\leq x^2+y^2+z^2\leq4$.<br>
> Vi gör sfärisk substitution och får
> 
> $$\iiint_K(x^2+y^2)dxdydz=\iiint_{\substack{1\leq r\leq2\\0\leq\phi\leq\pi\\0\leq\theta\leq2\pi}}r^2\sin^2(\phi)r^2\sin(\phi)drd\phi d\theta=\iiint_{\substack{1\leq r\leq2\\0\leq\phi\leq\pi\\0\leq\theta\leq2\pi}}r^4\sin^3(\phi)drd\phi d\theta\\=2\pi\int_1^2r^4dr\cdot\int_0^\pi\sin^3(\phi)d\phi=\frac{62\pi}5\cdot\frac43=\frac{248\pi}{15}$$
> 
> **Svar:** $\frac{248\pi}{15}$

#### Allmän substitution
Vid byte till allmänna koordinater $u,v,w$ ändras en trippelintegral enligt formeln

$$\iiint_Df(x,y,z)dxdydz=\iiint_Df(x(u,v,w),y(u,v,w),z(u,v,w))\left|\det\frac{\partial(x,y,z)}{\partial(u,v,w)}\right|dudvdw$$

> **Förklaring:**<br>
> Vi partitionerar området i små rätblock. Dessa avbildas lokalt till approximativa parallellepipeder av den linjära avbildningen $J=\frac{\partial(x,y,z)}{\partial(u,v,w)}$, vars volymer blir $\Delta V_{ijk}=\Delta u_i\Delta v_j\Delta w_k|\det J|$.<br>
> Bidraget från varje liten parallellepiped är $f(x(u_i,v_j,w_k),y(u_i,v_j,w_k),z(u_i,v_j,w_k))|\det J|\Delta u_i\Delta v_j\Delta w_k$<br>
> Detta kan ställas upp som en riemannsumma som konvergerar mot trippelintegralens värde.

### Symmetrier
Om en funktion $f(x,y,z)$ är udda i $x$-led, dvs. $f(-x,y,z)=-f(x,y,z)$, och integreras över ett område som är symmetriskt i $x$-led, kommer $\iiint f(x,y,z)dxdydz=0$.

## Föreläsning 21
### Parameterytor
En *parameteryta* är en yta där $x,y,z$-koordinaterna styrs av två parametrar $s,t$.

> **Exempel:** Parametrisera ytorna och ange parameterområdet.<br>
> a) paraboloid med spets i origo och som går genom punkten $(0,2,2)$, med $0\leq z\leq2$<br>
> Paraboloiden kan beskrivas av $z=k(x^2+y^2)$. Den givna punkten ger $k=\frac12$, och för parametrisering kan vi t.ex. anta $(s,t)=(x,y)$:
> 
> $$\vec r(s,t)=(s,t,\frac12(s^2+t^2))$$
> 
> där $s^2+t^2\leq4$, dvs parameterområdet är en cirkelskiva med medelpunkt i origo och radie 2.
> 
> b) enhetssfär (tänkt mittpunkt $(0,0,0)$) med begränsning $0\leq z\leq1$<br>
> Vi ser att alla punkter på ytan uppfyller $\begin{cases}r=1\\0\leq\phi\leq\frac\pi2\\0\leq\theta\lt2\pi\end{cases}$, med polära koordinater, och vi kan då välja $(r,\theta,\phi)=(4,s,t)$. I rektangulära koordinater får vi slutligen
> 
> $$\vec r(s,t)=(\cos s\sin t,\sin s\sin t,\cos t)$$
> 
> där $0\leq s\leq\frac\pi2,0\leq t\leq2\pi$

> **Övning:** Parametrisera ytorna och ange parameterområdet.<br>
> a) cylindriskt skal med radie 2 med medelaxel $(x,y)=(0,0)$, och begränsad till $0\leq z\leq2$<br>
> I cylindriska koordinater $\begin{cases}r=2\\0\leq\theta\leq2\pi\\0\leq z\leq2\end{cases}$. En parametrisering kan vara
> 
> $$\vec r(s,t)=(2r\cos s,2r\sin s,2t)$$
> 
> där $0\leq s\leq2\pi,0\leq t\leq2$.
> 
> b) koniskt skal<br>
> I cylindriska koordinater ges ytan av $0\leq z=r\leq2$. En parameterform i rektangulära koordinater ges av
> 
> $$\vec r(s,t)=(s\cos t,s\sin t,s)$$

### Area av buktiga ytor
#### Area av ett parallellogram
Ett parallellogram som har kantvektorer $\vec u,\vec v$ har arean

$$A=||\vec u\times\vec v||$$

#### Area av en parameteryta
En kontinuerligt deriverbar parameteryta

$$\vec r(s,t)=(x(s,t),y(s,t),z(s,t))$$

där $(s,t)\in D$ har arean

$$A={\int\int}_D\left|\frac{\partial\vec r}{\partial s}\times\frac{\partial\vec r}{\partial t}\right|dsdt$$
> **Härledning:**<br>
> Vi delar in parameterområdet i små rektanglar. Lokalt avbildas dessa approximativt av den linjära approximationen med koefficientmatris
> 
> $$J=\frac{\partial(x,y,z)}{\partial(s,t)}=\begin{bmatrix}\vert&\vert\\\frac{\partial\vec r}{\partial s}&\frac{\partial\vec r}{\partial t}\\\vert&\vert\end{bmatrix}$$
> 
> Varje rektangel avbildas därmed approximativt till ett parallellogram med area $\left|\frac{\partial\vec r}{\partial s}\times\frac{\partial\vec r}{\partial t}\right|\Delta s\Delta t$.<br>
> Detta kan skrivas upp som en riemannsumma, som konvergerar mot parameterytans area.

Uttrycket

$$dS=\left|\frac{\partial\vec r}{\partial s}\times\frac{\partial\vec r}{\partial t}\right|dsdt$$

kallas för *areaelementet*. Arean av ytan $S$ ges då av

$${\int\int}_SdS={\int\int}_D\left|\frac{\partial\vec r}{\partial s}\times\frac{\partial\vec r}{\partial t}\right|dsdt$$

där $\vec r(s,t)$ är en parametrisering av ytan $S$ med parameterområdet $D$.

> **Exempel:** Bestäm arean av ytan $\begin{cases}x=u-v\\y=u+v\\z=u^2-2uv-v^2\end{cases}$ där $u^2+v^2\lt2$ och $u-v\gt0$.<br>
> Arean ges av
> 
> $$A={\int\int}_D\left|\frac{\partial\vec r}{\partial u}\times\frac{\partial\vec r}{\partial v}\right|dudv={\int\int}_D\left|\begin{pmatrix}1\\1\\2u-2v\end{pmatrix}\times\begin{pmatrix}-1\\1\\-2u-2v\end{pmatrix}\right|dudv\\={\int\int}_D\left|\begin{pmatrix}-4u\\4v\\2\end{pmatrix}\right|dudv={\int\int}_D2\sqrt{1+4(u^2+v^2)}dudv=\{\text{byt till polära koordinater}\}\\=\int_{-3\pi/4}^{\pi/4}\int_0^{\sqrt2}2\sqrt{1+4r^2}rdrd\theta=\left\{\begin{matrix}t=1+4r^2\\dr=\frac1{8r}dt\end{matrix}\right\}=\frac14\int_{-3\pi/4}^{\pi/4}\int_1^9\sqrt{t}dtd\theta=\frac\pi6[t^{1.5}]_1^9=\frac{13\pi}3$$
> 
> **Svar:** Arean är $13\pi/3$ a.e.


#### Areaelement för några vanliga ytor
|Yta|Parametrisering|Areaelement|
|-|-|-|
|Cylinder med radie $R$|$\vec r(\theta,z)\\=(R\cos\theta,R\sin\theta,z)$|$dS=Rd\theta dz$|
|Sfär med radie $R$|$\vec r(\theta,\phi)\\=(R\sin\phi\cos\theta,R\sin\phi\sin\theta,R\cos\phi)$|$dS=R^2\sin\phi d\phi d\theta$|
|Funktionsyta $z=f(x,y)$|$\vec r(x,y)=(x,y,f(x,y))$|$dS=\\\sqrt{1+(f'_x)^2+(f'_y)^2}dxdy$|

> **Exempel:** Beräkna arean av den hyperboliska paraboloiden $z=xy$ inuti cylindern $x^2+y^2\leq1$.<br>
> $A={\int\int}_{x^2+y^2\leq1}\sqrt{1+y^2+x^2}dxdy=\int_0^{2\pi}\int_0^1\sqrt{1+r^2}rdrd\theta=\left\{\begin{matrix}t=1+r^2\\dr=\frac1{2r}dt\end{matrix}\right\}\\=\pi\int_1^2\sqrt tdt=\frac{2\pi}3[t^{1.5}]_1^2=\frac{2\pi}3(2\sqrt2-1)$<br>
> **Svar:** Arean är $\frac{2\pi}3(2\sqrt2-1)$ a.e.

## Föreläsning 22
### Ytbegrepp
* **Orienterad yta:** En yta som ges in- och utsida. *Observera att alla ytor inte kan orienteras.*
* **Utåtriktad normal:** Ett sätt att indikera ytans orientering.

### Flödesintegral
T.ex. flödet av en vätska genom en yta.

#### Konstant flöde genom ett parallellogram
En vätska flödar i rummet med hastighet $\vec v$. Genom ett parallellogram med kantvektorer $\vec u,\vec w$ är flödet per tidsenhet

$$\Phi=\vec v\cdot(\vec u\times\vec w)$$

#### Flöde genom en parameteryta
Flödet genom en parameteryta ges av

$$\iint_D\vec F\cdot\hat ndS=\iint_D\vec F\cdot d\vec S=\iint_D\vec F\cdot\left(\frac{\partial\vec r}{\partial s},\frac{\partial\vec r}{\partial t}\right)dsdt$$

där $d\vec S$ kallas för det *vektoriella ytelementet* och $\vec r(s,t)$ är en parametrisering av ytan $D$.

> **Exempel:** Beräkna $\iint_S(xy,yz,xz)\cdot d\vec S$ där $S$ är ytan som ges av $\vec r(s,t)=(\cos(s),t,\sin(s))$ för $0\leq s\leq\frac\pi2,0\leq t\leq2$<br>
> Det vektoriella ytelementet är: $\left(\frac{\partial\vec r}{\partial s}\times\frac{\partial\vec r}{\partial t}\right)dsdt=\left(\begin{bmatrix}-\sin(s)\\0\\\cos(s)\end{bmatrix}\times\begin{bmatrix}0\\1\\0\end{bmatrix}\right)dsdt=\begin{bmatrix}-\cos(s)\\0\\-\sin(s)\end{bmatrix}dsdt$
> 
> $$\iint_S(xy,yz,xz)\cdot d\vec S=\iint_S\begin{pmatrix}t\cos(s)\\t\sin(s)\\\cos(s)\sin(s)\end{pmatrix}\cdot\begin{pmatrix}-\cos(s)\\0\\-\sin(s)\end{pmatrix}dsdt\\=\iint_S-t\cos^2(s)-\cos(s)\sin^2(s)dsdt=-\frac\pi2-\frac23$$

I vissa situationer är det en fördel att skriva det vektoriella ytelementet som

$$d\vec S=\hat ndS$$

> **Exempel:** Beräkna $\iint_S\vec F\cdot d\vec S$ där $\vec F=(x,y,z)$ ut genom ytan $S:x^2+z^2=16,x\geq0,0\leq y\leq2$.<br>
> Vi har enhetsnormalen $\hat n=\frac14(x,0,z)$ och således $d\vec S=\hat ndS$<br>
> Detta ger:
> 
> $$\frac14\iint_S(x,y,z)\cdot(x,0,z)dS=\frac14\iint_Sx^2+z^2dS=4\iint_SdS=\{4\cdot\text{arean}\}=32\pi$$

> **Exempel:** Beräkna flödet av vektorfältet $\vec F=(x,y+1,z)$ upp genom halvsfären $x^2+y^2+z^2=9,z\geq0$.<br>
> Vi har enhetsnormalen $\hat n=\frac13(x,y,z)\implies d\vec S=\frac13(x,y,z)dS$<br>
> Integralen beräknas:
> 
> $$\iint_S\vec F\cdot d\vec S=\frac13\iint_S(x^2+y^2+y+z^2)dS=\frac13\iint_S(9+y)dS=\left\{\begin{matrix}y\text{ är udda i x-led \&}\\S\text{ symmetriskt i x-led}\end{matrix}\right\}\\=3\iint_SdS=3\cdot\frac{4\pi}2\cdot3^2=54\pi$$

> **Exempel:** Beräkna $\iint_S(2x,2y,3)\cdot d\vec S$ där $S$ är den del av paraboloiden $z=4-x^2-y^2$ ovanför x,y-planet och orienterad så att den utåtriktade normalen har positiv z-koordinat.<br>
> Vi kan parametrisera ytan som $\vec r(s,t)=(s,t,4-s^2-t^2)$.<br>
> Vektoriella ytelementet: $d\vec S=\left(\begin{bmatrix}1\\0\\-2s\end{bmatrix}\times\begin{bmatrix}0\\1\\-2t\end{bmatrix}\right)dsdt=\begin{pmatrix}2s\\2t\\1\end{pmatrix}dsdt$
> 
> $$\iint_S(2s,2t,3)\cdot(2s,2t,1)dsdt=\iint_{\substack{x^2+y^2\leq4}}(4(s^2+t^2)+3)dsdt\\=\iint_{\substack{0\leq r\leq2\\0\leq\theta\leq2\pi}}(4r^2+3)rdrd\theta=2\pi\int_0^2(4r^3+3r)dr=44\pi$$

### Räkneregler
* **Additivitet:** Flödet ut ur en yta kan beskrivas som summan ut ur två delytor.
* **Orientering:** Byte av orientering ger omvänt tecken på flödesintegralens värde.
* **Linjaritet:** Som vanligt gäller att termer kan delas upp, och att konstanta produkter kan brytas ut.

## Föreläsning 23
### Flöde
Om $S$ är randytan till ett öppet område så definieras flödet av ett vektorfält $\vec F$ ut ur området som

$${\int\int}_S\hat n\cdot \vec FdS$$

där $\hat n$ är den utåtpekande enhetsnormalen.

> **Exempel 1:** Låt $\vec F=(a+bx+cy+ez,f+gx+hy+iz,j+kx+ly+mz)$ och $D$ vara en fyrhörning. Visa att flödet av $\vec F$ ut ur fyrhörningens randyta $S$ ges av
> 
> $$\boxed{\oiint_S\hat n\cdot\vec FdS=(b+h+m)\cdot V}$$
> 
> där $V$ är fyrhörningens volym.
> 
> ...

> **Övning:**
> Beräkna flödet av $\vec F=(1-x,y-z,x+2z)$ ut ur<br>
> a) fyrhörningen $P:(0,0,0),(4,0,0),(0,4,0),(0,0,2)$<br>
> $\oiint_{\partial S}\vec F\cdot\hat ndS=((-1)+1+2)\cdot V=\frac{32}3$<br>
> **Svar:** 32/3
> 
> b) femhörningen $P:(0,0,0),(4,0,0),(4,4,0),(0,4,0),(0,0,2)$<br>
> Denna kan delas upp i två fyrhörningar. Vi beräknar då summan av flödet ut ur de två delarna.<br>
> *Notera att det inte spelar någon roll att vi integrerar över den gemensamma sidan "i mitten", eftersom vi gör detta två gånger, och i "motsatt riktning" - de tar då ut varandra.*<br>
> $\oiint_{\partial P}\vec F\cdot d\vec S=\oiint_{\partial P_1}\vec F\cdot d\vec S+\oiint_{\partial P_2}\vec F\cdot d\vec S=2\cdot V(P_1)+2\cdot V(P_2)=\frac{64}3$<br>
> **Svar:** 64/3

### Divergens (*flödesdensitet*)
Uttrycket

$$\text{div}\ \vec F=\nabla\cdot\vec F$$

kallas för *divergensen* av $\vec F$ och mäter hur mycket vektorfältet flödar ut ur en punkt.

Ett vektorfält kallas för *källfritt* om $\text{div}\ \vec F=0$ överallt.
> **Övning:** Bestäm divergensen av $\vec F$.<br>
> a) $\vec F=(z,x,y)$<br>
> **Svar:** Källfritt.
> 
> b) $\vec F=(x^2+yz,y^2+xz,z^2+xy)$<br>
> $\text{div}\ \vec F=(\frac\partial{\partial x},\frac\partial{\partial y},\frac\partial{\partial z})\cdot(x^2+yz,y^2+xz,z^2+xy)=2x+2y+2z$<br>
> **Svar:** $\text{div}\ \vec F=2x+2y+2yz$

#### Divergensen som flödesdensitet
Divergensen kan ses som en flödesdensitet och ges av

$$\text{div}\ \vec F(a,b,c)=\lim_{\text{volym}(D)\to0}\frac1{\text{volym}(D)}\oiint_D\hat n\cdot\vec FdS$$

där $D$ är en fyrhörning som innehåller $(a,b,c)$ och $\partial D$ är dess randyta.

> **Exempel:** Härled formeln ovan.<br>
> Låt $\vec F=(P,Q,R)$<br>
> Vi gör en linjär approximation av vektorfältet:
> 
> $$\vec F(a+h,b+k,c+l)=\begin{pmatrix}P(a,b,c)+P'_x(a,b,c)h+P'_y(a,b,c)k+P'_z(a,b,c)l\\Q(a,b,c)+Q'_x(a,b,c)h+Q'_y(a,b,c)k+Q'_z(a,b,c)l\\R(a,b,c)+R'_x(a,b,c)h+R'_y(a,b,c)k+R'_z(a,b,c)l\end{pmatrix}+\text{felterm}$$
> 
> Vi får då:
> 
> $$\oiint\vec F\cdot d\vec S=\oiint(\text{linjärt vektorfält})\cdot d\vec S+\text{felterm}\\=\{\text{skriver om enligt ex. 1}\}=(P'_x(a,b,c)+Q'_y(a,b,c)+R'_z(a,b,c))\cdot\text{volym}+\text{felterm}$$
> 
> Efter division i båda led med volymen, och då volymen gå mot 0, får vi:
> 
> $$\lim_{\text{volym}\to0}\frac1{\text{volym}}\oiint\vec F\cdot d\vec S=\text{div}\ \vec F(a,b,c)$$

#### Gauss sats
Låt $D$ vara ett *kompakt område* med en rand som består av styckvis deriverbara ytstycken (*dvs. finns kontinurligt deriverbara parametriseringar av ytan*), och $\vec F=(P,Q,R)$ vara ett kontinuerligt deriverbart vektorfält. Då gäller:

$$\oiint_{\partial D}\hat n\cdot\vec FdS=\iiint_D\text{div}\ \vec Fdxdydz$$

där $\hat n$ är den utåtpekande enhetsnormalen.

Dvs. *flödet ut ur $D$ kan beräknas genom att integrera flödesdensiteten (divergensen) över $D$*.

> **Övning:** Skriv om flödesintegralerna som trippelintegraler med Gauss sats och förenkla.<br>
> a) $\oiint_{\partial K}\hat n\cdot(xy^2,y,xz^2)$ där $K$ är halvklotet $0\leq r\leq2,0\leq\phi\leq\frac\pi2$<br>
> $=\iiint_K\left(\frac\partial{\partial x}xy^2+\frac\partial{\partial y}y+\frac\partial{\partial z}xz^2\right)dxdydz\\=\iiint_K(y^2+1+2xz)dxdydz=\iiint_Ky^2dxdydz+\frac{16}3\pi+0$
> 
> b) $\oiint_{\partial K}\hat n\cdot(x^2,y^2,z^2)dS$ där $K$ är kuben $\begin{cases}-1\leq x\leq1\\-1\leq y\leq1\\0\leq z\leq2\end{cases}$<br>
> $=\iiint_K\text{div}(x^2,y^2,z^2)dxdydz=\iint_K(2x+2y+2z)dxdydz\\=2\iiint_Kxdxdydz+2\iiint_Kydxdydz+2\iiint_Kzdxdydz=2\iiint_Kzdxdydz$

> **Exempel:** Beräkna flödet av vektorfältet $\vec F=(x^3y,xz,yz^3)$ ut från området $x^2+z^2\leq1,0\leq y\leq1,x\geq0,z\geq0$.
> 
> $$\iint_{\partial D}\vec F\cdot\hat ndS=\iiint_D\text{div}\ \vec Fdxdydz=\iiint_D3x^2y+3yz^2dxdydz\\=\{\text{typ cylindriska}\}=3\iiint_{\substack{0\leq r\leq1\\0\leq y\leq1\\0\leq\theta\leq\frac\pi2}}yr^2\left|\det\begin{bmatrix}\cos\theta&-r\sin\theta&0\\0&0&1\\\sin\theta&r\cos\theta&0\end{bmatrix}\right|drd\theta dy\\=3\frac\pi2\int_0^1\left(\int_0^1yr^3dr\right)dy=\frac{3\pi}2\int_0^1\frac y4dy=\frac{3\pi}{16}$$

#### Gauss sats baklänges
$$\iiint_Kf(x,y,z)dxdydz=\oiint_{\partial K}\vec F\cdot d\vec S$$

där vektorfältet $\vec F$ uppfyller $\text{div}\ \vec F=f(x,y,z)$.

Detta kan jämföras med integralkalkylens huvudsats för enkelintegralen. I båda fallen reduceras en integral över hela området till att undersöka en "primitiv funktion" på randen.

## Föreläsning 24
### Orienterade randkurvor
Om en orienterad yta har en randkurva induceras en orientering av randkurvan enligt högerhandsregeln (tummen motsvarar normalen, och fingrarna randkurvans orientering).

### Cirkulation
Om $S$ är en enkel sluten yta definieras cirkulationen av ett vektorfält $\vec F$ runt $S$ som

$$\oiint_S\hat n\times\vec FdS$$

där $\hat n$ är den utåtpekande enhetsnormalen.

Cirkulationen mäter hur mycket $\vec F$ flöder utmed ytan $S$, dvs. hur vektorfältet roterar runt ytan. Dess riktning anger rotationsaxelns riktning enligt högerhandsregeln.

> **Exempel:** Bestäm cirkulationen för $\vec F=(0,z,-y)$ runt randytan till området $y^2+z^2\leq1,0\leq x\leq1$.<br>
> $\oiint_{S_1}(0,y,z)\times(0,z,-y)dS=\oiint_{S_1}(-y^2-z^2,0,0)dS=\oiint_{S_1}(-1,0,0)dS=(-1,0,0)\oiint_{S_1}dS\\=(-2\pi,0,0)$<br>
> $\oiint_{S_2}(1,0,0)\times(0,z,-y)dS=\oiint_{S_2}(0,y,z)dS=\left(0,\oiint_{S_2}ydS,\oiint_{S_2}zdS\right)=(0,0,0)$<br>
> Motsvarande för den andra cirkelskivan.
> 
> $$\oiint_S\hat n\times\vec FdS=(-2\pi,0,0)+\vec0+\vec0=(-2,0,0)$$

### Rotation (*cirkulationstäthet*)
Rotationen av ett vektorfält $\vec F$ definieras som

$$\text{rot}\ \vec F=\nabla\times\vec F$$

Dess belopp anger hur mycket vektorfältet virvlar i en punkt och riktningen anger rotationsaxeln enligt högerhandsregeln.

Ett vektorfält $\vec F$ kallas för rotationsfritt om $\text{rot}\ \vec F=\vec0$ överallt.

#### Rotation som cirkulationstäthet
Rotationen kan ses som en cirkulationsdensitet och ges av

$$\text{rot}\ \vec F(a,b,c)=\lim_{\text{volym}(D)\to0}\frac1{\text{volym}(D)}\oiint_{\partial D}\hat n\times\vec FdS$$

där $D$ är en fyrhörning som innehåller $(a,b,c)$ och $\partial D$ är dess randyta.

### Stokes sats
Antag att $S$ är en orienterad yta med en orienterad randkurva $\partial S$. Om $\vec F=(P,Q,R)$ är ett kontinuerligt deriverbart vektorfält, så är

$$\int_{\partial S}\vec F\cdot d\vec r=\iint_S(\text{rot}\ \vec F)\cdot d\vec S$$

### Vektorpotential i rummet
Ett vektorfält $\vec A$ kallas för en vektorpotential till ett källfritt vektorfält $\vec F$ om

$$\vec F=\text{rot}\ \vec A$$

*Om $\vec F$ inte är källfritt finns ingen vektorpotential.*

Observera att vektorpotentialen inte är unik. Även $\vec A+\vec G$, där $\vec G$ är ett konservativt vektorfält, är en vektorpotential eftersom

$$\text{rot}(\vec A+\vec G)=\text{rot}\ \vec A+\text{rot}\ \vec G=\vec F+\vec0=\vec F$$

#### Stokes sats baklänges
För källfria vektorfält $\vec F$ kan Stokes sats formuleras som

$$\iint_S\vec F\cdot d\vec S=\oint_{\partial S}\vec A\cdot d\vec r$$

där $\vec A$ är en vektorpotential till $\vec F$.


